(function(e){e.extend(e.fn,{validate:function(t){if(!this.length){t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.");return}var n=e.data(this[0],"validator");return n?n:(this.attr("novalidate","novalidate"),n=new e.validator(t,this[0]),e.data(this[0],"validator",n),n.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){n.settings.submitHandler&&(n.submitButton=t.target),e(t.target).hasClass("cancel")&&(n.cancelSubmit=!0),e(t.target).attr("formnovalidate")!==undefined&&(n.cancelSubmit=!0)}),this.submit(function(t){function r(){var r;return n.settings.submitHandler?(n.submitButton&&(r=e("<input type='hidden'/>").attr("name",n.submitButton.name).val(e(n.submitButton).val()).appendTo(n.currentForm)),n.settings.submitHandler.call(n,n.currentForm,t),n.submitButton&&r.remove(),!1):!0}return n.settings.debug&&t.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,r()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):r():(n.focusInvalid(),!1)})),n)},valid:function(){if(e(this[0]).is("form"))return this.validate().form();var t=!0,n=e(this[0].form).validate();return this.each(function(){t=t&&n.element(this)}),t},removeAttrs:function(t){var n={},r=this;return e.each(t.split(/\s/),function(e,t){n[t]=r.attr(t),r.removeAttr(t)}),n},rules:function(t,n){var r=this[0];if(t){var i=e.data(r.form,"validator").settings,s=i.rules,o=e.validator.staticRules(r);switch(t){case"add":e.extend(o,e.validator.normalizeRule(n)),delete o.messages,s[r.name]=o,n.messages&&(i.messages[r.name]=e.extend(i.messages[r.name],n.messages));break;case"remove":if(!n)return delete s[r.name],o;var u={};return e.each(n.split(/\s/),function(e,t){u[t]=o[t],delete o[t]}),u}}var a=e.validator.normalizeRules(e.extend({},e.validator.classRules(r),e.validator.attributeRules(r),e.validator.dataRules(r),e.validator.staticRules(r)),r);if(a.required){var f=a.required;delete a.required,a=e.extend({required:f},a)}return a}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){return!!e.trim(""+e(t).val())},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,n){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=n,this.init()},e.validator.format=function(t,n){return arguments.length===1?function(){var n=e.makeArray(arguments);return n.unshift(t),e.validator.format.apply(this,n)}:(arguments.length>2&&n.constructor!==Array&&(n=e.makeArray(arguments).slice(1)),n.constructor!==Array&&(n=[n]),e.each(n,function(e,n){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return n})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e,t){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e,t){!this.checkable(e)&&(e.name in this.submitted||!this.optional(e))&&this.element(e)},onkeyup:function(e,t){if(t.which===9&&this.elementValue(e)==="")return;(e.name in this.submitted||e===this.lastElement)&&this.element(e)},onclick:function(e,t){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).addClass(n).removeClass(r):e(t).addClass(n).removeClass(r)},unhighlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).removeClass(n).addClass(r):e(t).removeClass(n).addClass(r)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"必选字段",remote:"请修正该字段",email:"请输入正确格式的电子邮件",url:"请输入合法的网址",date:"请输入合法的日期",dateISO:"请输入合法的日期 (ISO).",number:"请输入合法的数字",digits:"只能输入整数",creditcard:"请输入合法的信用卡号",equalTo:"请再次输入相同的值",accept:"请输入拥有合法后缀名的字符串",maxlength:e.validator.format("请输入一个长度最多是 {0} 的字符串"),minlength:e.validator.format("请输入一个长度最少是 {0} 的字符串"),rangelength:e.validator.format("请输入一个长度介于 {0} 和 {1} 之间的字符串"),range:e.validator.format("请输入一个介于 {0} 和 {1} 之间的值"),max:e.validator.format("请输入一个最大为 {0} 的值"),min:e.validator.format("请输入一个最小为 {0} 的值")},autoCreateRanges:!1,prototype:{init:function(){function r(t){var n=e.data(this[0].form,"validator"),r="on"+t.type.replace(/^validate/,"");n.settings[r]&&n.settings[r].call(n,this[0],t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var t=this.groups={};e.each(this.settings.groups,function(n,r){typeof r=="string"&&(r=r.split(/\s/)),e.each(r,function(e,r){t[r]=n})});var n=this.settings.rules;e.each(n,function(t,r){n[t]=e.validator.normalizeRule(r)}),e(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",r).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",r),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=e(t);var n=this.check(t)!==!1;return n?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),n},showErrors:function(t){if(t){e.extend(this.errorMap,t),this.errorList=[];for(var n in t)this.errorList.push({message:t[n],element:this.findByName(n)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t=0;for(var n in e)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()===0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&e.grep(this.errorList,function(e){return e.element.name===t.name}).length===1&&t},elements:function(){var t=this,n={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in n||!t.objectLength(e(this).rules())?!1:(n[this.name]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return e(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var n=e(t).attr("type"),r=e(t).val();return n==="radio"||n==="checkbox"?e("input[name='"+e(t).attr("name")+"']:checked").val():typeof r=="string"?r.replace(/\r/g,""):r},check:function(t){t=this.validationTargetFor(this.clean(t));var n=e(t).rules(),r=!1,i=this.elementValue(t),s;for(var o in n){var u={method:o,parameters:n[o]};try{s=e.validator.methods[o].call(this,i,t,u.parameters);if(s==="dependency-mismatch"){r=!0;continue}r=!1;if(s==="pending"){this.toHide=this.toHide.not(this.errorsFor(t));return}if(!s)return this.formatAndAdd(t,u),!1}catch(a){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+u.method+"' method.",a),a}}if(r)return;return this.objectLength(n)&&this.successList.push(t),!0},customDataMessage:function(t,n){return e(t).data("msg-"+n.toLowerCase())||t.attributes&&e(t).attr("data-msg-"+n.toLowerCase())},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor===String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==undefined)return arguments[e];return undefined},defaultMessage:function(t,n){return this.findDefined(this.customMessage(t.name,n),this.customDataMessage(t,n),!this.settings.ignoreTitle&&t.title||undefined,e.validator.messages[n],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,n){var r=this.defaultMessage(t,n.method),i=/\$?\{(\d+)\}/g;typeof r=="function"?r=r.call(this,n.parameters,t):i.test(r)&&(r=e.validator.format(r.replace(i,"{$1}"),n.parameters)),this.errorList.push({message:r,element:t}),this.errorMap[t.name]=r,this.submitted[t.name]=r},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t;for(e=0;this.errorList[e];e++){var n=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,n.element,this.settings.errorClass,this.settings.validClass),this.showLabel(n.element,n.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,n){var r=this.errorsFor(t);r.length?(r.removeClass(this.settings.validClass).addClass(this.settings.errorClass),r.html(n)):(r=e("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(n||""),this.settings.wrapper&&(r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(r).length||(this.settings.errorPlacement?this.settings.errorPlacement(r,e(t)):r.insertAfter(t))),!n&&this.settings.success&&(r.text(""),typeof this.settings.success=="string"?r.addClass(this.settings.success):this.settings.success(r,t)),this.toShow=this.toShow.add(r)},errorsFor:function(t){var n=this.idOrName(t);return this.errors().filter(function(){return e(this).attr("for")===n})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name).not(this.settings.ignore)[0]),e},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+t+"']")},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return e("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e,t){return e},string:function(t,n){return!!e(t,n.form).length},"function":function(e,t){return e(t)}},optional:function(t){var n=this.elementValue(t);return!e.validator.methods.required.call(this,n,t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],n&&this.pendingRequest===0&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!n&&this.pendingRequest===0&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,n){t.constructor===String?this.classRuleSettings[t]=n:e.extend(this.classRuleSettings,t)},classRules:function(t){var n={},r=e(t).attr("class");return r&&e.each(r.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(n,e.validator.classRuleSettings[this])}),n},attributeRules:function(t){var n={},r=e(t),i=r[0].getAttribute("type");for(var s in e.validator.methods){var o;s==="required"?(o=r.get(0).getAttribute(s),o===""&&(o=!0),o=!!o):o=r.attr(s),/min|max/.test(s)&&(i===null||/number|range|text/.test(i))&&(o=Number(o)),o?n[s]=o:i===s&&i!=="range"&&(n[s]=!0)}return n.maxlength&&/-1|2147483647|524288/.test(n.maxlength)&&delete n.maxlength,n},dataRules:function(t){var n,r,i={},s=e(t);for(n in e.validator.methods)r=s.data("rule-"+n.toLowerCase()),r!==undefined&&(i[n]=r);return i},staticRules:function(t){var n={},r=e.data(t.form,"validator");return r.settings.rules&&(n=e.validator.normalizeRule(r.settings.rules[t.name])||{}),n},normalizeRules:function(t,n){return e.each(t,function(r,i){if(i===!1){delete t[r];return}if(i.param||i.depends){var s=!0;switch(typeof i.depends){case"string":s=!!e(i.depends,n.form).length;break;case"function":s=i.depends.call(n,n)}s?t[r]=i.param!==undefined?i.param:!0:delete t[r]}}),e.each(t,function(r,i){t[r]=e.isFunction(i)?i(n):i}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var n;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:typeof t[this]=="string"&&(n=t[this].split(/[\s,]+/),t[this]=[Number(n[0]),Number(n[1])]))}),e.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if(typeof t=="string"){var n={};e.each(t.split(/\s/),function(){n[this]=!0}),t=n}return t},addMethod:function(t,n,r){e.validator.methods[t]=n,e.validator.messages[t]=r!==undefined?r:e.validator.messages[t],n.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,n,r){if(!this.depend(r,n))return"dependency-mismatch";if(n.nodeName.toLowerCase()==="select"){var i=e(n).val();return i&&i.length>0}return this.checkable(n)?this.getLength(t,n)>0:e.trim(t).length>0},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test((new Date(e)).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;var n=0,r=0,i=!1;e=e.replace(/\D/g,"");for(var s=e.length-1;s>=0;s--){var o=e.charAt(s);r=parseInt(o,10),i&&(r*=2)>9&&(r-=9),n+=r,i=!i}return n%10===0},minlength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(e.trim(t),n);return this.optional(n)||i>=r},maxlength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(e.trim(t),n);return this.optional(n)||i<=r},rangelength:function(t,n,r){var i=e.isArray(t)?t.length:this.getLength(e.trim(t),n);return this.optional(n)||i>=r[0]&&i<=r[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},equalTo:function(t,n,r){var i=e(r);return this.settings.onfocusout&&i.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(n).valid()}),t===i.val()},remote:function(t,n,r){if(this.optional(n))return"dependency-mismatch";var i=this.previousValue(n);this.settings.messages[n.name]||(this.settings.messages[n.name]={}),i.originalMessage=this.settings.messages[n.name].remote,this.settings.messages[n.name].remote=i.message,r=typeof r=="string"&&{url:r}||r;if(i.old===t)return i.valid;i.old=t;var s=this;this.startRequest(n);var o={};return o[n.name]=t,e.ajax(e.extend(!0,{url:r,mode:"abort",port:"validate"+n.name,dataType:"json",data:o,success:function(r){s.settings.messages[n.name].remote=i.originalMessage;var o=r===!0||r==="true";if(o){var u=s.formSubmitted;s.prepareElement(n),s.formSubmitted=u,s.successList.push(n),delete s.invalid[n.name],s.showErrors()}else{var a={},f=r||s.defaultMessage(n,"remote");a[n.name]=i.message=e.isFunction(f)?f(t):f,s.invalid[n.name]=!0,s.showErrors(a)}i.valid=o,s.stopRequest(n,o)}},r)),"pending"}}}),e.format=e.validator.format})(jQuery),function(e){var t={};if(e.ajaxPrefilter)e.ajaxPrefilter(function(e,n,r){var i=e.port;e.mode==="abort"&&(t[i]&&t[i].abort(),t[i]=r)});else{var n=e.ajax;e.ajax=function(r){var i=("mode"in r?r:e.ajaxSettings).mode,s=("port"in r?r:e.ajaxSettings).port;return i==="abort"?(t[s]&&t[s].abort(),t[s]=n.apply(this,arguments),t[s]):n.apply(this,arguments)}}}(jQuery),function(e){e.extend(e.fn,{validateDelegate:function(t,n,r){return this.bind(n,function(n){var i=e(n.target);if(i.is(t))return r.apply(i,arguments)})}})}(jQuery),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof exports=="object"?e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),!function(e,t){"use strict";var n={"font-styles":"<li class='dropdown'><a class='btn dropdown-toggle' data-toggle='dropdown' href='#'><i class='icon-font'></i>&nbsp;<span class='current-font'>普通文本</span>&nbsp;<b class='caret'></b></a><ul class='dropdown-menu'><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='div'>普通文本</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h2'>标题 2</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h3'>标题 3</a></li></ul>"+'<a class="btn" data-wysihtml5-command="formatBlock" title="代码" data-wysihtml5-command-value="pre">代码</a>'+'<a class="btn" data-wysihtml5-command="formatBlock" title="引用" data-wysihtml5-command-value="blockquote">引用</a>'+"</li>",emphasis:"<li><div class='btn-group'><a class='btn' data-wysihtml5-command='bold' title='CTRL+B'>加粗</a><a class='btn' data-wysihtml5-command='italic' title='CTRL+I'>斜体</a><a class='btn' data-wysihtml5-command='underline' title='CTRL+U'>下划线</a></div></li>",lists:"<li><div class='btn-group'><a class='btn' data-wysihtml5-command='insertUnorderedList' title='无序列表'><i class='icon-list'></i></a><a class='btn' data-wysihtml5-command='insertOrderedList' title='有序列表'><i class='icon-th-list'></i></a><a class='btn' data-wysihtml5-command='Outdent' title='缩进'><i class='icon-indent-right'></i></a><a class='btn' data-wysihtml5-command='Indent' title='缩出'><i class='icon-indent-left'></i></a></div></li>",link:"<li><div class='bootstrap-wysihtml5-insert-link-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>插入链接</h3></div><div class='modal-body'><input placeholder='http://' class='bootstrap-wysihtml5-insert-link-url input-xlarge' type='url'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>取消</a><a href='#' class='btn btn-primary' data-dismiss='modal'>插入链接</a></div></div><a class='btn' data-wysihtml5-command='createLink' title='链接'><i class='icon-share'></i></a></li>",image:"<li><div class='bootstrap-wysihtml5-insert-image-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>插入图片</h3></div><div class='modal-body'><input placeholder='http://' class='bootstrap-wysihtml5-insert-image-url input-xlarge' type='url'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>取消</a><a href='#' class='btn btn-primary' data-dismiss='modal'>插入图片</a></div></div><a class='btn' data-wysihtml5-command='insertImage' title='图片'><i class='icon-picture'></i></a></li>",html:"<li><div class='btn-group'><a class='btn' data-wysihtml5-action='change_view' title='编辑HTML'><i class='icon-pencil'></i> HTML</a></div></li>"},r={"font-styles":!0,emphasis:!0,lists:!0,html:!1,link:!0,image:!0,events:{},parserRules:{classes:{table:1,list:1},tags:{tr:{add_class:{align:"align_text"}},strike:{remove:1},form:{rename_tag:"div"},rt:{rename_tag:"span"},code:{},acronym:{rename_tag:"span"},br:{add_class:{clear:"clear_br"}},details:{rename_tag:"div"},h4:{add_class:{align:"align_text"}},em:{},title:{remove:1},multicol:{rename_tag:"div"},figure:{rename_tag:"div"},xmp:{rename_tag:"span"},small:{rename_tag:"span",set_class:"wysiwyg-font-size-smaller"},area:{remove:1},time:{rename_tag:"span"},dir:{rename_tag:"ul"},bdi:{rename_tag:"span"},command:{remove:1},ul:{},progress:{rename_tag:"span"},dfn:{rename_tag:"span"},iframe:{remove:1},figcaption:{rename_tag:"div"},a:{check_attributes:{href:"url"},set_attributes:{rel:"nofollow",target:"_blank"}},img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"},add_class:{align:"align_img"}},rb:{rename_tag:"span"},footer:{rename_tag:"div"},noframes:{remove:1},abbr:{rename_tag:"span"},u:{},bgsound:{remove:1},sup:{rename_tag:"span"},address:{rename_tag:"div"},basefont:{remove:1},nav:{rename_tag:"div"},h1:{add_class:{align:"align_text"}},head:{remove:1},tbody:{add_class:{align:"align_text"}},dd:{rename_tag:"div"},s:{rename_tag:"span"},li:{},td:{check_attributes:{rowspan:"numbers",colspan:"numbers"},add_class:{align:"align_text"}},object:{remove:1},div:{add_class:{align:"align_text"}},option:{rename_tag:"span"},select:{rename_tag:"span"},i:{},track:{remove:1},wbr:{remove:1},fieldset:{rename_tag:"div"},big:{rename_tag:"span",set_class:"wysiwyg-font-size-larger"},button:{rename_tag:"span"},noscript:{remove:1},svg:{remove:1},input:{remove:1},table:{},keygen:{remove:1},h5:{add_class:{align:"align_text"}},meta:{remove:1},map:{rename_tag:"div"},isindex:{remove:1},mark:{rename_tag:"span"},caption:{add_class:{align:"align_text"}},tfoot:{add_class:{align:"align_text"}},base:{remove:1},video:{remove:1},strong:{},canvas:{remove:1},output:{rename_tag:"span"},marquee:{rename_tag:"span"},b:{},q:{check_attributes:{cite:"url"}},applet:{remove:1},span:{},rp:{rename_tag:"span"},spacer:{remove:1},source:{remove:1},aside:{rename_tag:"div"},frame:{remove:1},section:{rename_tag:"div"},body:{rename_tag:"div"},ol:{},nobr:{rename_tag:"span"},html:{rename_tag:"div"},summary:{rename_tag:"span"},"var":{rename_tag:"span"},del:{remove:1},blockquote:{check_attributes:{cite:"url"}},style:{remove:1},device:{remove:1},meter:{rename_tag:"span"},h3:{add_class:{align:"align_text"}},textarea:{rename_tag:"span"},embed:{remove:1},hgroup:{rename_tag:"div"},font:{rename_tag:"span",add_class:{size:"size_font"}},tt:{rename_tag:"span"},noembed:{remove:1},thead:{add_class:{align:"align_text"}},blink:{rename_tag:"span"},plaintext:{rename_tag:"span"},xml:{remove:1},h6:{add_class:{align:"align_text"}},param:{remove:1},th:{check_attributes:{rowspan:"numbers",colspan:"numbers"},add_class:{align:"align_text"}},legend:{rename_tag:"span"},hr:{},label:{rename_tag:"span"},dl:{rename_tag:"div"},kbd:{rename_tag:"span"},listing:{rename_tag:"div"},dt:{rename_tag:"span"},nextid:{remove:1},pre:{},center:{rename_tag:"div",set_class:"wysiwyg-text-align-center"},audio:{remove:1},datalist:{rename_tag:"span"},samp:{rename_tag:"span"},col:{remove:1},article:{rename_tag:"div"},cite:{},link:{remove:1},script:{remove:1},bdo:{rename_tag:"span"},menu:{rename_tag:"ul"},colgroup:{remove:1},ruby:{rename_tag:"span"},h2:{add_class:{align:"align_text"}},ins:{rename_tag:"span"},p:{add_class:{align:"align_text"}},sub:{rename_tag:"span"},comment:{remove:1},frameset:{remove:1},optgroup:{rename_tag:"span"},header:{rename_tag:"div"}}},stylesheets:[]},i=function(t,n){this.el=t,this.toolbar=this.createToolbar(t,n||r),this.editor=this.createEditor(n),window.editor=this.editor,e("iframe.wysihtml5-sandbox").each(function(t,n){e(n.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){e("li.dropdown").removeClass("open")}})})};i.prototype={constructor:i,createEditor:function(n){n=e.extend(r,n||{}),n.toolbar=this.toolbar[0];var i=new t.Editor(this.el[0],n);if(n&&n.events)for(var s in n.events)i.on(s,n.events[s]);return i},createToolbar:function(t,i){var s=this,o=e("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"});for(var u in r){var a=!1;i[u]!==undefined?i[u]===!0&&(a=!0):a=r[u],a===!0&&(o.append(n[u]),u=="html"&&this.initHtml(o),u=="link"&&this.initInsertLink(o),u=="image"&&this.initInsertImage(o))}return o.find("a[data-wysihtml5-command='formatBlock']").click(function(t){var n=e(t.srcElement);s.toolbar.find(".current-font").text(n.html())}),this.el.before(o),o},initHtml:function(e){var t="a[data-wysihtml5-action='change_view']";e.find(t).click(function(n){e.find("a.btn").not(t).toggleClass("disabled")})},initInsertImage:function(e){var t=this,n=e.find(".bootstrap-wysihtml5-insert-image-modal"),r=n.find(".bootstrap-wysihtml5-insert-image-url"),i=n.find("a.btn-primary"),s=r.val(),o=function(){var e=r.val();r.val(s),t.editor.composer.commands.exec("insertImage",e)};r.keypress(function(e){e.which==13&&(o(),n.modal("hide"))}),i.click(o),n.on("shown",function(){r.focus()}),n.on("hide",function(){t.editor.currentView.element.focus()}),e.find("a[data-wysihtml5-command=insertImage]").click(function(){return n.modal("show"),n.on("click.dismiss.modal",'[data-dismiss="modal"]',function(e){e.stopPropagation()}),!1})},initInsertLink:function(e){var t=this,n=e.find(".bootstrap-wysihtml5-insert-link-modal"),r=n.find(".bootstrap-wysihtml5-insert-link-url"),i=n.find("a.btn-primary"),s=r.val(),o=function(){var e=r.val();r.val(s),t.editor.composer.commands.exec("createLink",{href:e,target:"_blank",rel:"nofollow"})},u=!1;r.keypress(function(e){e.which==13&&(o(),n.modal("hide"))}),i.click(o),n.on("shown",function(){r.focus()}),n.on("hide",function(){t.editor.currentView.element.focus()}),e.find("a[data-wysihtml5-command=createLink]").click(function(){return n.modal("show"),n.on("click.dismiss.modal",'[data-dismiss="modal"]',function(e){e.stopPropagation()}),!1})}},e.fn.wysihtml5=function(t){return this.each(function(){var n=e(this);n.data("wysihtml5",new i(n,t))})},e.fn.wysihtml5.Constructor=i}(window.jQuery,window.wysihtml5),"use strict";var Markdown;typeof exports=="object"&&typeof require=="function"?Markdown=exports:Markdown={},function(){function e(e){return e}function t(e){return!1}function n(){}function r(){}n.prototype={chain:function(t,n){var r=this[t];if(!r)throw new Error("unknown hook "+t);r===e?this[t]=n:this[t]=function(e){var t=Array.prototype.slice.call(arguments,0);return t[0]=r.apply(null,t),n.apply(null,t)}},set:function(e,t){if(!this[e])throw new Error("unknown hook "+e);this[e]=t},addNoop:function(t){this[t]=e},addFalse:function(e){this[e]=t}},Markdown.HookCollection=n,r.prototype={set:function(e,t){this["s_"+e]=t},get:function(e){return this["s_"+e]}},Markdown.Converter=function(){function u(e){return e=e.replace(/^[ ]{0,3}\[([^\[\]]+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(e,n,r,s,o,u){return n=n.toLowerCase(),t.set(n,O(r)),o?s:(u&&i.set(n,u.replace(/"/g,"&quot;")),"")}),e}function a(e){var t="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del",n="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";return e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,l),e=e.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,l),e=e.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,l),e=e.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,l),e=e.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,l),e}function f(e){return e=e.replace(/(^\n+|\n+$)/g,""),"\n\n~K"+(s.push(e)-1)+"K\n\n"}function l(e,t){return f(t)}function h(t,n){t=e.preBlockGamut(t,c),t=w(t);var r="<hr />\n";return t=t.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,r),t=t.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,r),t=t.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,r),t=E(t),t=T(t),t=L(t),t=e.postBlockGamut(t,c),t=a(t),t=A(t,n),t}function p(t){return t=e.preSpanGamut(t),t=N(t),t=d(t),t=M(t),t=g(t),t=v(t),t=j(t),t=t.replace(/~P/g,"://"),t=O(t),t=k(t),t=t.replace(/  +\n/g," <br>\n"),t=e.postSpanGamut(t),t}function d(e){var t=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi;return e=e.replace(t,function(e){var t=e.replace(/(.)<\/?code>(?=.)/g,"$1`");return t=z(t,e.charAt(1)=="!"?"\\`*_/":"\\`*_"),t}),e}function v(e){return e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,m),e=e.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()\s])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,m),e=e.replace(/(\[([^\[\]]+)\])()()()()()/g,m),e}function m(e,n,r,s,o,u,a,f){f==undefined&&(f="");var l=n,c=r.replace(/:\/\//g,"~P"),h=s.toLowerCase(),p=o,d=f;if(p==""){h==""&&(h=c.toLowerCase().replace(/ ?\n/g," ")),p="#"+h;if(t.get(h)!=undefined)p=t.get(h),i.get(h)!=undefined&&(d=i.get(h));else{if(!(l.search(/\(\s*\)$/m)>-1))return l;p=""}}p=U(p),p=z(p,"*_");var v='<a href="'+p+'"';return d!=""&&(d=y(d),d=z(d,"*_"),v+=' title="'+d+'"'),v+=">"+c+"</a>",v}function g(e){return e=e.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,b),e=e.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,b),e}function y(e){return e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")}function b(e,n,r,s,o,u,a,f){var l=n,c=r,h=s.toLowerCase(),p=o,d=f;d||(d="");if(p==""){h==""&&(h=c.toLowerCase().replace(/ ?\n/g," ")),p="#"+h;if(t.get(h)==undefined)return l;p=t.get(h),i.get(h)!=undefined&&(d=i.get(h))}c=z(y(c),"*_[]()"),p=z(p,"*_");var v='<img src="'+p+'" alt="'+c+'"';return d=y(d),d=z(d,"*_"),v+=' title="'+d+'"',v+=" />",v}function w(e){return e=e.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(e,t){return"<h1>"+p(t)+"</h1>\n\n"}),e=e.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,t){return"<h2>"+p(t)+"</h2>\n\n"}),e=e.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(e,t,n){var r=t.length;return"<h"+r+">"+p(n)+"</h"+r+">\n\n"}),e}function E(e,t){e+="~0";var n=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;return o?e=e.replace(n,function(e,n,r){var i=n,s=r.search(/[*+-]/g)>-1?"ul":"ol",o=x(i,s,t);return o=o.replace(/\s+$/,""),o="<"+s+">"+o+"</"+s+">\n",o}):(n=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,e=e.replace(n,function(e,t,n,r){var i=t,s=n,o=r.search(/[*+-]/g)>-1?"ul":"ol",u=x(s,o);return u=i+"<"+o+">\n"+u+"</"+o+">\n",u})),e=e.replace(/~0/,""),e}function x(e,t,n){o++,e=e.replace(/\n{2,}$/,"\n"),e+="~0";var r=S[t],i=new RegExp("(^[ \\t]*)("+r+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+r+")[ \\t]+))","gm"),s=!1;return e=e.replace(i,function(e,t,r,i){var o=i,u=t,a=/\n\n$/.test(o),f=a||o.search(/\n{2,}/)>-1;return f||s?o=h(I(o),!0):(o=E(I(o),!0),o=o.replace(/\n$/,""),n||(o=p(o))),s=a,"<li>"+o+"</li>\n"}),e=e.replace(/~0/g,""),o--,e}function T(e){return e+="~0",e=e.replace(/(?:\n\n|^\n?)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(e,t,n){var r=t,i=n;return r=C(I(r)),r=q(r),r=r.replace(/^\n+/g,""),r=r.replace(/\n+$/g,""),r="<pre><code>"+r+"\n</code></pre>","\n\n"+r+"\n\n"+i}),e=e.replace(/~0/,""),e}function N(e){return e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(e,t,n,r,i){var s=r;return s=s.replace(/^([ \t]*)/g,""),s=s.replace(/[ \t]*$/g,""),s=C(s),s=s.replace(/:\/\//g,"~P"),t+"<code>"+s+"</code>"}),e}function C(e){return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=z(e,"*_{}[]\\",!1),e}function k(e){return e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)\2(?=\S)([^\r]*?\S)\2\2(?!\2)(?=[\W_]|$)/g,"$1<strong>$3</strong>"),e=e.replace(/(^|[\W_])(?:(?!\1)|(?=^))(\*|_)(?=\S)((?:(?!\2)[^\r])*?\S)\2(?!\2)(?=[\W_]|$)/g,"$1<em>$3</em>"),e}function L(e){return e=e.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(e,t){var n=t;return n=n.replace(/^[ \t]*>[ \t]?/gm,"~0"),n=n.replace(/~0/g,""),n=n.replace(/^[ \t]+$/gm,""),n=h(n),n=n.replace(/(^|\n)/g,"$1  "),n=n.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(e,t){var n=t;return n=n.replace(/^  /mg,"~0"),n=n.replace(/~0/g,""),n}),f("<blockquote>\n"+n+"\n</blockquote>")}),e}function A(e,t){e=e.replace(/^\n+/g,""),e=e.replace(/\n+$/g,"");var n=e.split(/\n{2,}/g),r=[],i=/~K(\d+)K/,o=n.length;for(var u=0;u<o;u++){var a=n[u];i.test(a)?r.push(a):/\S/.test(a)&&(a=p(a),a=a.replace(/^([ \t]*)/g,"<p>"),a+="</p>",r.push(a))}if(!t){o=r.length;for(var u=0;u<o;u++){var f=!0;while(f)f=!1,r[u]=r[u].replace(/~K(\d+)K/g,function(e,t){return f=!0,s[t]})}}return r.join("\n\n")}function O(e){return e=e.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),e=e.replace(/<(?![a-z\/?!]|~D)/gi,"&lt;"),e}function M(e){return e=e.replace(/\\(\\)/g,W),e=e.replace(/\\([`*_{}\[\]()>#+-.!])/g,W),e}function B(e,t,n,r){if(t)return e;if(r.charAt(r.length-1)!==")")return"<"+n+r+">";var i=r.match(/[()]/g),s=0;for(var o=0;o<i.length;o++)i[o]==="("?s<=0?s=1:s++:s--;var u="";if(s<0){var a=new RegExp("\\){1,"+ -s+"}$");r=r.replace(a,function(e){return u=e,""})}if(u){var f=r.charAt(r.length-1);H.test(f)||(u=f+u,r=r.substr(0,r.length-1))}return"<"+n+r+">"+u}function j(t){t=t.replace(P,B);var n=function(t,n){return'<a href="'+U(n)+'">'+e.plainLinkText(n)+"</a>"};return t=t.replace(/<((https?|ftp):[^'">\s]+)>/gi,n),t}function F(e){return e=e.replace(/~E(\d+)E/g,function(e,t){var n=parseInt(t);return String.fromCharCode(n)}),e}function I(e){return e=e.replace(/^(\t|[ ]{1,4})/gm,"~0"),e=e.replace(/~0/g,""),e}function q(e){if(!/\t/.test(e))return e;var t=["    ","   ","  "," "],n=0,r;return e.replace(/[\n\t]/g,function(e,i){return e==="\n"?(n=i+1,e):(r=(i-n)%4,n=i+1,t[r])})}function U(e){if(!e)return"";var t=e.length;return e.replace(R,function(n,r){if(n=="~D")return"%24";if(n==":")if(r==t-1||/[0-9\/]/.test(e.charAt(r+1)))return":";return"%"+n.charCodeAt(0).toString(16)})}function z(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var i=new RegExp(r,"g");return e=e.replace(i,W),e}function W(e,t){var n=t.charCodeAt(0);return"~E"+n+"E"}var e=this.hooks=new n;e.addNoop("plainLinkText"),e.addNoop("preConversion"),e.addNoop("postNormalization"),e.addNoop("preBlockGamut"),e.addNoop("postBlockGamut"),e.addNoop("preSpanGamut"),e.addNoop("postSpanGamut"),e.addNoop("postConversion");var t,i,s,o;this.makeHtml=function(n){if(t)throw new Error("Recursive call to converter.makeHtml");return t=new r,i=new r,s=[],o=0,n=e.preConversion(n),n=n.replace(/~/g,"~T"),n=n.replace(/\$/g,"~D"),n=n.replace(/\r\n/g,"\n"),n=n.replace(/\r/g,"\n"),n="\n\n"+n+"\n\n",n=q(n),n=n.replace(/^[ \t]+$/mg,""),n=e.postNormalization(n),n=a(n),n=u(n),n=h(n),n=F(n),n=n.replace(/~D/g,"$$"),n=n.replace(/~T/g,"~"),n=e.postConversion(n),s=i=t=null,n};var c=function(e){return h(e)},S={ol:"\\d+[.]",ul:"[*+-]"},_="[-A-Z0-9+&@#/%?=~_|[\\]()!:,.;]",D="[-A-Z0-9+&@#/%=~_|[\\])]",P=new RegExp('(="|<)?\\b(https?|ftp)(://'+_+"*"+D+")(?=$|\\W)","gi"),H=new RegExp(D,"i"),R=/(?:["'*()[\]:_]|~D)/g}}(),function(){function n(e){return e.replace(/<[^>]*>?/gi,o)}function o(e){return e.match(r)||e.match(i)||e.match(s)?e:""}function u(e){if(e=="")return"";var t=/<\/?\w+[^>]*(\s|$|>)/g,n=e.toLowerCase().match(t),r=(n||[]).length;if(r==0)return e;var i,s,o="<p><img><br><li><hr>",u,a=[],f=[],l=!1;for(var c=0;c<r;c++){i=n[c].replace(/<\/?(\w+).*/,"$1");if(a[c]||o.search("<"+i+">")>-1)continue;s=n[c],u=-1;if(!/^<\//.test(s))for(var h=c+1;h<r;h++)if(!a[h]&&n[h]=="</"+i+">"){u=h;break}u==-1?l=f[c]=!0:a[u]=!0}if(!l)return e;var c=0;return e=e.replace(t,function(e){var t=f[c]?"":e;return c++,t}),e}var e,t;typeof exports=="object"&&typeof require=="function"?(e=exports,t=require("./Markdown.Converter").Converter):(e=window.Markdown,t=e.Converter),e.getSanitizingConverter=function(){var e=new t;return e.hooks.chain("postConversion",n),e.hooks.chain("postConversion",u),e};var r=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,i=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,s=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i}(),function(){function c(){}function h(e){this.buttonBar=r.getElementById("wmd-button-bar"+e),this.preview=r.getElementById("wmd-preview"+e),this.input=r.getElementById("wmd-input"+e)}function p(t,n){var r=this,i=[],s=0,o="none",a,f,l,c=function(e,t){o!=e&&(o=e,t||p()),!u.isIE||o!="moving"?f=setTimeout(h,1):l=null},h=function(e){l=new d(n,e),f=undefined};this.setCommandMode=function(){o="command",p(),f=setTimeout(h,0)},this.canUndo=function(){return s>1},this.canRedo=function(){return i[s+1]?!0:!1},this.undo=function(){r.canUndo()&&(a?(a.restore(),a=null):(i[s]=new d(n),i[--s].restore(),t&&t())),o="none",n.input.focus(),h()},this.redo=function(){r.canRedo()&&(i[++s].restore(),t&&t()),o="none",n.input.focus(),h()};var p=function(){var e=l||new d(n);if(!e)return!1;if(o=="moving"){a||(a=e);return}a&&(i[s-1].text!=a.text&&(i[s++]=a),a=null),i[s++]=e,i[s+1]=null,t&&t()},v=function(e){var t=!1;if((e.ctrlKey||e.metaKey)&&!e.altKey){var n=e.charCode||e.keyCode,i=String.fromCharCode(n);switch(i.toLowerCase()){case"y":r.redo(),t=!0;break;case"z":e.shiftKey?r.redo():r.undo(),t=!0}}if(t){e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1);return}},m=function(e){if(!e.ctrlKey&&!e.metaKey){var t=e.keyCode;t>=33&&t<=40||t>=63232&&t<=63235?c("moving"):t==8||t==46||t==127?c("deleting"):t==13?c("newlines"):t==27?c("escape"):(t<16||t>20)&&t!=91&&c("typing")}},g=function(){e.addEvent(n.input,"keypress",function(e){(e.ctrlKey||e.metaKey)&&!e.altKey&&(e.keyCode==89||e.keyCode==90)&&e.preventDefault()});var t=function(){(u.isIE||l&&l.text!=n.input.value)&&f==undefined&&(o="paste",p(),h())};e.addEvent(n.input,"keydown",v),e.addEvent(n.input,"keydown",m),e.addEvent(n.input,"mousedown",function(){c("moving")}),n.input.onpaste=t,n.input.ondrop=t},y=function(){g(),h(!0),p()};y()}function d(t,n){var i=this,s=t.input;this.init=function(){if(!e.isVisible(s))return;if(!n&&r.activeElement&&r.activeElement!==s)return;this.setInputAreaSelectionStartEnd(),this.scrollTop=s.scrollTop;if(!this.text&&s.selectionStart||s.selectionStart===0)this.text=s.value},this.setInputAreaSelection=function(){if(!e.isVisible(s))return;if(s.selectionStart!==undefined&&!u.isOpera)s.focus(),s.selectionStart=i.start,s.selectionEnd=i.end,s.scrollTop=i.scrollTop;else if(r.selection){if(r.activeElement&&r.activeElement!==s)return;s.focus();var t=s.createTextRange();t.moveStart("character",-s.value.length),t.moveEnd("character",-s.value.length),t.moveEnd("character",i.end),t.moveStart("character",i.start),t.select()}},this.setInputAreaSelectionStartEnd=function(){if(!t.ieCachedRange&&(s.selectionStart||s.selectionStart===0))i.start=s.selectionStart,i.end=s.selectionEnd;else if(r.selection){i.text=e.fixEolChars(s.value);var n=t.ieCachedRange||r.selection.createRange(),o=e.fixEolChars(n.text),u="",a=u+o+u;n.text=a;var f=e.fixEolChars(s.value);n.moveStart("character",-a.length),n.text=o,i.start=f.indexOf(u),i.end=f.lastIndexOf(u)-u.length;var l=i.text.length-e.fixEolChars(s.value).length;if(l){n.moveStart("character",-o.length);while(l--)o+="\n",i.end+=1;n.text=o}t.ieCachedRange&&(i.scrollTop=t.ieCachedScrollTop),t.ieCachedRange=null,this.setInputAreaSelection()}},this.restore=function(){i.text!=undefined&&i.text!=s.value&&(s.value=i.text),this.setInputAreaSelection(),s.scrollTop=i.scrollTop},this.getChunks=function(){var t=new c;return t.before=e.fixEolChars(i.text.substring(0,i.start)),t.startTag="",t.selection=e.fixEolChars(i.text.substring(i.start,i.end)),t.endTag="",t.after=e.fixEolChars(i.text.substring(i.end)),t.scrollTop=i.scrollTop,t},this.setChunks=function(e){e.before=e.before+e.startTag,e.after=e.endTag+e.after,this.start=e.before.length,this.end=e.before.length+e.selection.length,this.text=e.before+e.selection+e.after,this.scrollTop=e.scrollTop},this.init()}function v(n,i,s){var o=this,a,f,l,c=3e3,h="delayed",p=function(t,n){e.addEvent(t,"input",n),t.onpaste=n,t.ondrop=n,e.addEvent(t,"keypress",n),e.addEvent(t,"keydown",n)},d=function(){var e=0;return window.innerHeight?e=window.pageYOffset:r.documentElement&&r.documentElement.scrollTop?e=r.documentElement.scrollTop:r.body&&(e=r.body.scrollTop),e},v=function(){if(!i.preview)return;var e=i.input.value;if(e&&e==l)return;l=e;var t=(new Date).getTime();e=n.makeHtml(e);var r=(new Date).getTime();f=r-t,T(e)},m=function(){a&&(clearTimeout(a),a=undefined);if(h!=="manual"){var e=0;h==="delayed"&&(e=f),e>c&&(e=c),a=setTimeout(v,e)}},g=function(e){return e.scrollHeight<=e.clientHeight?1:e.scrollTop/(e.scrollHeight-e.clientHeight)},y=function(){i.preview&&(i.preview.scrollTop=(i.preview.scrollHeight-i.preview.clientHeight)*g(i.preview))};this.refresh=function(e){e?(l="",v()):m()},this.processingTime=function(){return f};var b=!0,w=function(e){var t=i.preview,n=t.parentNode,r=t.nextSibling;n.removeChild(t),t.innerHTML=e,r?n.insertBefore(t,r):n.appendChild(t)},E=function(e){i.preview.innerHTML=e},S,x=function(e){if(S)return S(e);try{E(e),S=E}catch(t){S=w,S(e)}},T=function(e){var n=t.getTop(i.input)-d();i.preview&&(x(e),s()),y();if(b){b=!1;return}var r=t.getTop(i.input)-d();u.isIE?setTimeout(function(){window.scrollBy(0,r-n)},0):window.scrollBy(0,r-n)},N=function(){p(i.input,m),v(),i.preview&&(i.preview.scrollTop=0)};N()}function m(t,n,i,o,a,f,l){function v(e){c.focus();if(e.textOp){i&&i.setCommandMode();var t=new d(n);if(!t)return;var r=t.getChunks(),s=function(){c.focus(),r&&t.setChunks(r),t.restore(),o.refresh()},u=e.textOp(r,s);u||s()}e.execute&&e.execute(i)}function m(e,t){var i="0px",s="-20px",o="-40px",a=e.getElementsByTagName("span")[0];t?(a.style.backgroundPosition=e.XShift+" "+i,e.onmouseover=function(){a.style.backgroundPosition=this.XShift+" "+o},e.onmouseout=function(){a.style.backgroundPosition=this.XShift+" "+i},u.isIE&&(e.onmousedown=function(){if(r.activeElement&&r.activeElement!==n.input)return;n.ieCachedRange=document.selection.createRange(),n.ieCachedScrollTop=n.input.scrollTop}),e.isHelp||(e.onclick=function(){return this.onmouseout&&this.onmouseout(),v(this),!1})):(a.style.backgroundPosition=e.XShift+" "+s,e.onmouseover=e.onmouseout=e.onclick=function(){})}function g(e){return typeof e=="string"&&(e=a[e]),function(){e.apply(a,arguments)}}function y(){var e=n.buttonBar,r="0px",i="-20px",o="-40px",u=document.createElement("ul");u.id="wmd-button-row"+t,u.className="wmd-button-row",u=e.appendChild(u);var a=0,c=function(e,n,r,i){var s=document.createElement("li");s.className="wmd-button",s.style.left=a+"px",a+=25;var o=document.createElement("span");return s.id=e+t,s.appendChild(o),s.title=n,s.XShift=r,i&&(s.textOp=i),m(s,!0),u.appendChild(s),s},p=function(e){var n=document.createElement("li");n.className="wmd-spacer wmd-spacer"+e,n.id="wmd-spacer"+e+t,u.appendChild(n),a+=25};h.bold=c("wmd-bold-button",l("bold"),"0px",g("doBold")),h.italic=c("wmd-italic-button",l("italic"),"-20px",g("doItalic")),p(1),h.link=c("wmd-link-button",l("link"),"-40px",g(function(e,t){return this.doLinkOrImage(e,t,!1)})),h.quote=c("wmd-quote-button",l("quote"),"-60px",g("doBlockquote")),h.code=c("wmd-code-button",l("code"),"-80px",g("doCode")),h.image=c("wmd-image-button",l("image"),"-100px",g(function(e,t){return this.doLinkOrImage(e,t,!0)})),p(2),h.olist=c("wmd-olist-button",l("olist"),"-120px",g(function(e,t){this.doList(e,t,!0)})),h.ulist=c("wmd-ulist-button",l("ulist"),"-140px",g(function(e,t){this.doList(e,t,!1)})),h.heading=c("wmd-heading-button",l("heading"),"-160px",g("doHeading")),h.hr=c("wmd-hr-button",l("hr"),"-180px",g("doHorizontalRule")),p(3),h.undo=c("wmd-undo-button",l("undo"),"-200px",null),h.undo.execute=function(e){e&&e.undo()};var d=/win/.test(s.platform.toLowerCase())?l("redo"):l("redomac");h.redo=c("wmd-redo-button",d,"-220px",null),h.redo.execute=function(e){e&&e.redo()};if(f){var v=document.createElement("li"),y=document.createElement("span");v.appendChild(y),v.className="wmd-button wmd-help-button",v.id="wmd-help-button"+t,v.XShift="-240px",v.isHelp=!0,v.style.right="0px",v.title=l("help"),v.onclick=f.handler,m(v,!0),u.appendChild(v),h.help=v}b()}function b(){i&&(m(h.undo,i.canUndo()),m(h.redo,i.canRedo()))}var c=n.input,h={};y();var p="keydown";u.isOpera&&(p="keypress"),e.addEvent(c,p,function(e){if((e.ctrlKey||e.metaKey)&&!e.altKey&&!e.shiftKey){var t=e.charCode||e.keyCode,n=String.fromCharCode(t).toLowerCase();switch(n){case"b":v(h.bold);break;case"i":v(h.italic);break;case"l":v(h.link);break;case"q":v(h.quote);break;case"k":v(h.code);break;case"g":v(h.image);break;case"o":v(h.olist);break;case"u":v(h.ulist);break;case"h":v(h.heading);break;case"r":v(h.hr);break;case"y":v(h.redo);break;case"z":e.shiftKey?v(h.redo):v(h.undo);break;default:return}e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1)}}),e.addEvent(c,"keyup",function(e){if(e.shiftKey&&!e.ctrlKey&&!e.metaKey){var t=e.charCode||e.keyCode;if(t===13){var n={};n.textOp=g("doAutoindent"),v(n)}}}),u.isIE&&e.addEvent(c,"keydown",function(e){var t=e.keyCode;if(t===27)return!1}),this.setUndoRedoButtonStates=b}function g(e,t){this.hooks=e,this.getString=t}function b(e){return e.replace(/^\s*(.*?)(?:\s+"(.+)")?\s*$/,function(e,t,n){return t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g," ")}),t=decodeURIComponent(t),t=encodeURI(t).replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29"),t=t.replace(/\?.*$/,function(e){return e.replace(/\+/g,"%2b")}),n&&(n=n.trim?n.trim():n.replace(/^\s*/,"").replace(/\s*$/,""),n=n.replace(/"/g,"quot;").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),n?t+' "'+n+'"':t})}var e={},t={},n={},r=window.document,i=window.RegExp,s=window.navigator,o={lineLength:72},u={isIE:/msie/.test(s.userAgent.toLowerCase()),isIE_5or6:/msie 6/.test(s.userAgent.toLowerCase())||/msie 5/.test(s.userAgent.toLowerCase()),isOpera:/opera/.test(s.userAgent.toLowerCase())},a={bold:"Strong <strong> Ctrl+B",boldexample:"strong text",italic:"Emphasis <em> Ctrl+I",italicexample:"emphasized text",link:"Hyperlink <a> Ctrl+L",linkdescription:"enter link description here",linkdialog:'<p><b>Insert Hyperlink</b></p><p>http://example.com/ "optional title"</p>',quote:"Blockquote <blockquote> Ctrl+Q",quoteexample:"Blockquote",code:"Code Sample <pre><code> Ctrl+K",codeexample:"enter code here",image:"Image <img> Ctrl+G",imagedescription:"enter image description here",imagedialog:"<p><b>Insert Image</b></p><p>http://example.com/images/diagram.jpg \"optional title\"<br><br>Need <a href='http://www.google.com/search?q=free+image+hosting' target='_blank'>free image hosting?</a></p>",olist:"Numbered List <ol> Ctrl+O",ulist:"Bulleted List <ul> Ctrl+U",litem:"List item",heading:"Heading <h1>/<h2> Ctrl+H",headingexample:"Heading",hr:"Horizontal Rule <hr> Ctrl+R",undo:"Undo - Ctrl+Z",redo:"Redo - Ctrl+Y",redomac:"Redo - Ctrl+Shift+Z",help:"Markdown Editing Help"},f="http://",l="http://";Markdown.Editor=function(e,t,n){n=n||{},typeof n.handler=="function"&&(n={helpButton:n}),n.strings=n.strings||{},n.helpButton&&(n.strings.help=n.strings.help||n.helpButton.title);var i=function(e){return n.strings[e]||a[e]};t=t||"";var s=this.hooks=new Markdown.HookCollection;s.addNoop("onPreviewRefresh"),s.addNoop("postBlockquoteCreation"),s.addFalse("insertImageDialog"),this.getConverter=function(){return e};var o=this,u;this.run=function(){if(u)return;u=new h(t);var a=new g(s,i),f=new v(e,u,function(){s.onPreviewRefresh()}),l,c;/\?noundo/.test(r.location.href)||(l=new p(function(){f.refresh(),c&&c.setUndoRedoButtonStates()},u),this.textOperation=function(e){l.setCommandMode(),e(),o.refreshPreview()}),c=new m(t,u,l,f,a,n.helpButton,i),c.setUndoRedoButtonStates();var d=o.refreshPreview=function(){f.refresh(!0)};d()}},c.prototype.findTags=function(t,n){var r=this,i;t&&(i=e.extendRegExp(t,"","$"),this.before=this.before.replace(i,function(e){return r.startTag=r.startTag+e,""}),i=e.extendRegExp(t,"^",""),this.selection=this.selection.replace(i,function(e){return r.startTag=r.startTag+e,""})),n&&(i=e.extendRegExp(n,"","$"),this.selection=this.selection.replace(i,function(e){return r.endTag=e+r.endTag,""}),i=e.extendRegExp(n,"^",""),this.after=this.after.replace(i,function(e){return r.endTag=e+r.endTag,""}))},c.prototype.trimWhitespace=function(e){var t,n,r=this;e?t=n="":(t=function(e){return r.before+=e,""},n=function(e){return r.after=e+r.after,""}),this.selection=this.selection.replace(/^(\s*)/,t).replace(/(\s*)$/,n)},c.prototype.skipLines=function(e,t,n){e===undefined&&(e=1),t===undefined&&(t=1),e++,t++;var r,s;navigator.userAgent.match(/Chrome/)&&"X".match(/()./),this.selection=this.selection.replace(/(^\n*)/,""),this.startTag=this.startTag+i.$1,this.selection=this.selection.replace(/(\n*$)/,""),this.endTag=this.endTag+i.$1,this.startTag=this.startTag.replace(/(^\n*)/,""),this.before=this.before+i.$1,this.endTag=this.endTag.replace(/(\n*$)/,""),this.after=this.after+i.$1;if(this.before){r=s="";while(e--)r+="\\n?",s+="\n";n&&(r="\\n*"),this.before=this.before.replace(new i(r+"$",""),s)}if(this.after){r=s="";while(t--)r+="\\n?",s+="\n";n&&(r="\\n*"),this.after=this.after.replace(new i(r,""),s)}},e.isVisible=function(e){if(window.getComputedStyle)return window.getComputedStyle(e,null).getPropertyValue("display")!=="none";if(e.currentStyle)return e.currentStyle.display!=="none"},e.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},e.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},e.fixEolChars=function(e){return e=e.replace(/\r\n/g,"\n"),e=e.replace(/\r/g,"\n"),e},e.extendRegExp=function(e,t,n){if(t===null||t===undefined)t="";if(n===null||n===undefined)n="";var r=e.toString(),s;return r=r.replace(/\/([gim]*)$/,function(e,t){return s=t,""}),r=r.replace(/(^\/|\/$)/g,""),r=t+r+n,new i(r,s)},t.getTop=function(e,t){var n=e.offsetTop;if(!t)while(e=e.offsetParent)n+=e.offsetTop;return n},t.getHeight=function(e){return e.offsetHeight||e.scrollHeight},t.getWidth=function(e){return e.offsetWidth||e.scrollWidth},t.getPageSize=function(){var e,t,n,i;self.innerHeight&&self.scrollMaxY?(e=r.body.scrollWidth,t=self.innerHeight+self.scrollMaxY):r.body.scrollHeight>r.body.offsetHeight?(e=r.body.scrollWidth,t=r.body.scrollHeight):(e=r.body.offsetWidth,t=r.body.offsetHeight),self.innerHeight?(n=self.innerWidth,i=self.innerHeight):r.documentElement&&r.documentElement.clientHeight?(n=r.documentElement.clientWidth,i=r.documentElement.clientHeight):r.body&&(n=r.body.clientWidth,i=r.body.clientHeight);var s=Math.max(e,n),o=Math.max(t,i);return[s,o,n,i]},n.createBackground=function(){var e=r.createElement("div"),n=e.style;e.className="wmd-prompt-background",n.position="absolute",n.top="0",n.zIndex="1000",u.isIE?n.filter="alpha(opacity=50)":n.opacity="0.5";var i=t.getPageSize();return n.height=i[1]+"px",u.isIE?(n.left=r.documentElement.scrollLeft,n.width=r.documentElement.clientWidth):(n.left="0",n.width="100%"),r.body.appendChild(e),e},n.prompt=function(n,i,s){var o,a;i===undefined&&(i="");var f=function(e){var t=e.charCode||e.keyCode;t===27&&l(!0)},l=function(t){e.removeEvent(r.body,"keydown",f);var n=a.value;return t?n=null:(n=n.replace(/^http:\/\/(https?|ftp):\/\//,"$1://"),/^(?:https?|ftp):\/\//.test(n)||(n="http://"+n)),o.parentNode.removeChild(o),s(n),!1},c=function(){o=r.createElement("div"),o.className="wmd-prompt-dialog",o.style.padding="10px;",o.style.position="fixed",o.style.width="400px",o.style.zIndex="1001";var s=r.createElement("div");s.innerHTML=n,s.style.padding="5px",o.appendChild(s);var c=r.createElement("form"),h=c.style;c.onsubmit=function(){return l(!1)},h.padding="0",h.margin="0",h.cssFloat="left",h.width="100%",h.textAlign="center",h.position="relative",o.appendChild(c),a=r.createElement("input"),a.type="text",a.value=i,h=a.style,h.display="block",h.width="80%",h.marginLeft=h.marginRight="auto",c.appendChild(a);var p=r.createElement("input");p.type="button",p.onclick=function(){return l(!1)},p.value="确定",p.className="btn btn-primary",h=p.style,h.margin="10px",h.display="inline",h.width="7em";var d=r.createElement("input");d.type="button",d.onclick=function(){return l(!0)},d.value="取消",d.className="btn",h=d.style,h.margin="10px",h.display="inline",h.width="7em",c.appendChild(p),c.appendChild(d),e.addEvent(r.body,"keydown",f),o.style.top="50%",o.style.left="50%",o.style.display="block",u.isIE_5or6&&(o.style.position="absolute",o.style.top=r.documentElement.scrollTop+200+"px",o.style.left="50%"),r.body.appendChild(o),o.style.marginTop=-(t.getHeight(o)/2)+"px",o.style.marginLeft=-(t.getWidth(o)/2)+"px"};setTimeout(function(){c();var e=i.length;if(a.selectionStart!==undefined)a.selectionStart=0,a.selectionEnd=e;else if(a.createTextRange){var t=a.createTextRange();t.collapse(!1),t.moveStart("character",-e),t.moveEnd("character",e),t.select()}a.focus()},0)};var y=g.prototype;y.prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",y.unwrap=function(e){var t=new i("([^\\n])\\n(?!(\\n|"+this.prefixes+"))","g");e.selection=e.selection.replace(t,"$1 $2")},y.wrap=function(e,t){this.unwrap(e);var n=new i("(.{1,"+t+"})( +|$\\n?)","gm"),r=this;e.selection=e.selection.replace(n,function(e,t){return(new i("^"+r.prefixes,"")).test(e)?e:t+"\n"}),e.selection=e.selection.replace(/\s+$/,"")},y.doBold=function(e,t){return this.doBorI(e,t,2,this.getString("boldexample"))},y.doItalic=function(e,t){return this.doBorI(e,t,1,this.getString("italicexample"))},y.doBorI=function(e,t,n,r){e.trimWhitespace(),e.selection=e.selection.replace(/\n{2,}/g,"\n");var s=/(\**$)/.exec(e.before)[0],o=/(^\**)/.exec(e.after)[0],u=Math.min(s.length,o.length);if(u>=n&&(u!=2||n!=1))e.before=e.before.replace(i("[*]{"+n+"}$",""),""),e.after=e.after.replace(i("^[*]{"+n+"}",""),"");else if(!e.selection&&o){e.after=e.after.replace(/^([*_]*)/,""),e.before=e.before.replace(/(\s?)$/,"");var a=i.$1;e.before=e.before+o+a}else{!e.selection&&!o&&(e.selection=r);var f=n<=1?"*":"**";e.before=e.before+f,e.after=f+e.after}return},y.stripLinkDefs=function(e,t){return e=e.replace(/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(e,n,r,i,s){return t[n]=e.replace(/\s*$/,""),i?(t[n]=e.replace(/["(](.+?)[")]$/,""),i+s):""}),e},y.addLinkDef=function(e,t){var n=0,r={};e.before=this.stripLinkDefs(e.before,r),e.selection=this.stripLinkDefs(e.selection,r),e.after=this.stripLinkDefs(e.after,r);var i="",s=/(\[)((?:\[[^\]]*\]|[^\[\]])*)(\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g,o=function(e){n++,e=e.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+n+"]:"),i+="\n"+e},u=function(e,t,i,a,f,l){return i=i.replace(s,u),r[f]?(o(r[f]),t+i+a+n+l):e};e.before=e.before.replace(s,u),t?o(t):e.selection=e.selection.replace(s,u);var a=n;return e.after=e.after.replace(s,u),e.after&&(e.after=e.after.replace(/\n*$/,"")),e.after||(e.selection=e.selection.replace(/\n*$/,"")),e.after+="\n\n"+i,a},y.doLinkOrImage=function(e,t,r){e.trimWhitespace(),e.findTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);var i;if(!(e.endTag.length>1&&e.startTag.length>0)){e.selection=e.startTag+e.selection+e.endTag,e.startTag=e.endTag="";if(/\n\n/.test(e.selection)){this.addLinkDef(e,null);return}var s=this,o=function(n){i.parentNode.removeChild(i);if(n!==null){e.selection=(" "+e.selection).replace(/([^\\](?:\\\\)*)(?=[[\]])/g,"$1\\").substr(1);var o=" [999]: "+b(n),u=s.addLinkDef(e,o);e.startTag=r?"![":"[",e.endTag="]["+u+"]",e.selection||(r?e.selection=s.getString("imagedescription"):e.selection=s.getString("linkdescription"))}t()};return i=n.createBackground(),r?this.hooks.insertImageDialog(o)||n.prompt(this.getString("imagedialog"),f,o):n.prompt(this.getString("linkdialog"),l,o),!0}e.startTag=e.startTag.replace(/!?\[/,""),e.endTag="",this.addLinkDef(e,null)},y.doAutoindent=function(e,t){var n=this,r=!1;e.before=e.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n"),e.before=e.before.replace(/(\n|^)[ \t]+\n$/,"\n\n"),!e.selection&&!/^[ \t]*(?:\n|$)/.test(e.after)&&(e.after=e.after.replace(/^[^\n]*/,function(t){return e.selection=t,""}),r=!0),/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]+.*\n$/.test(e.before)&&n.doList&&n.doList(e),/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(e.before)&&n.doBlockquote&&n.doBlockquote(e),/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&n.doCode&&n.doCode(e),r&&(e.after=e.selection+e.after,e.selection="")},y.doBlockquote=function(e,t){e.selection=e.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(t,n,r,i){return e.before+=n,e.after=i+e.after,r}),e.before=e.before.replace(/(>[ \t]*)$/,function(t,n){return e.selection=n+e.selection,""}),e.selection=e.selection.replace(/^(\s|>)+$/,""),e.selection=e.selection||this.getString("quoteexample");var n="",r="",i;if(e.before){var s=e.before.replace(/\n$/,"").split("\n"),u=!1;for(var a=0;a<s.length;a++){var f=!1;i=s[a],u=u&&i.length>0,/^>/.test(i)?(f=!0,!u&&i.length>1&&(u=!0)):/^[ \t]*$/.test(i)?f=!0:f=u,f?n+=i+"\n":(r+=n+i,n="\n")}/(^|\n)>/.test(n)||(r+=n,n="")}e.startTag=n,e.before=r,e.after&&(e.after=e.after.replace(/^\n?/,"\n")),e.after=e.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(t){return e.endTag=t,""});var l=function(t){var n=t?"> ":"";e.startTag&&(e.startTag=e.startTag.replace(/\n((>|\s)*)\n$/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"})),e.endTag&&(e.endTag=e.endTag.replace(/^\n((>|\s)*)\n/,function(e,t){return"\n"+t.replace(/^[ ]{0,3}>?[ \t]*$/gm,n)+"\n"}))};/^(?![ ]{0,3}>)/m.test(e.selection)?(this.wrap(e,o.lineLength-2),e.selection=e.selection.replace(/^/gm,"> "),l(!0),e.skipLines()):(e.selection=e.selection.replace(/^[ ]{0,3}> ?/gm,""),this.unwrap(e),l(!1),!/^(\n|^)[ ]{0,3}>/.test(e.selection)&&e.startTag&&(e.startTag=e.startTag.replace(/\n{0,2}$/,"\n\n")),!/(\n|^)[ ]{0,3}>.*$/.test(e.selection)&&e.endTag&&(e.endTag=e.endTag.replace(/^\n{0,2}/,"\n\n"))),e.selection=this.hooks.postBlockquoteCreation(e.selection),/\n/.test(e.selection)||(e.selection=e.selection.replace(/^(> *)/,function(t,n){return e.startTag+=n,""}))},y.doCode=function(e,t){var n=/\S[ ]*$/.test(e.before),r=/^[ ]*\S/.test(e.after);if(!r&&!n||/\n/.test(e.selection)){e.before=e.before.replace(/[ ]{4}$/,function(t){return e.selection=t+e.selection,""});var i=1,s=1;/(\n|^)(\t|[ ]{4,}).*\n$/.test(e.before)&&(i=0),/^\n(\t|[ ]{4,})/.test(e.after)&&(s=0),e.skipLines(i,s),e.selection?/^[ ]{0,3}\S/m.test(e.selection)?/\n/.test(e.selection)?e.selection=e.selection.replace(/^/gm,"    "):e.before+="    ":e.selection=e.selection.replace(/^(?:[ ]{4}|[ ]{0,3}\t)/gm,""):(e.startTag="    ",e.selection=this.getString("codeexample"))}else e.trimWhitespace(),e.findTags(/`/,/`/),!e.startTag&&!e.endTag?(e.startTag=e.endTag="`",e.selection||(e.selection=this.getString("codeexample"))):e.endTag&&!e.startTag?(e.before+=e.endTag,e.endTag=""):e.startTag=e.endTag=""},y.doList=function(e,t,n){var r=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,s=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,u="-",a=1,f=function(){var e;return n?(e=" "+a+". ",a++):e=" "+u+" ",e},l=function(e){return n===undefined&&(n=/^\s*\d/.test(e)),e=e.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(e){return f()}),e};e.findTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null),e.before&&!/\n$/.test(e.before)&&!/^\n/.test(e.startTag)&&(e.before+=e.startTag,e.startTag="");if(e.startTag){var c=/\d+[.]/.test(e.startTag);e.startTag="",e.selection=e.selection.replace(/\n[ ]{4}/g,"\n"),this.unwrap(e),e.skipLines(),c&&(e.after=e.after.replace(s,l));if(n==c)return}var h=1;e.before=e.before.replace(r,function(e){return/^\s*([*+-])/.test(e)&&(u=i.$1),h=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.selection||(e.selection=this.getString("litem"));var p=f(),d=1;e.after=e.after.replace(s,function(e){return d=/[^\n]\n\n[^\n]/.test(e)?1:0,l(e)}),e.trimWhitespace(!0),e.skipLines(h,d,!0),e.startTag=p;var v=p.replace(/./g," ");this.wrap(e,o.lineLength-v.length),e.selection=e.selection.replace(/\n/g,"\n"+v)},y.doHeading=function(e,t){e.selection=e.selection.replace(/\s+/g," "),e.selection=e.selection.replace(/(^\s+|\s+$)/g,"");if(!e.selection){e.startTag="## ",e.selection=this.getString("headingexample"),e.endTag=" ##";return}var n=0;e.findTags(/#+[ ]*/,/[ ]*#+/),/#+/.test(e.startTag)&&(n=i.lastMatch.length),e.startTag=e.endTag="",e.findTags(null,/\s?(-+|=+)/),/=+/.test(e.endTag)&&(n=1),/-+/.test(e.endTag)&&(n=2),e.startTag=e.endTag="",e.skipLines(1,1);var r=n==0?2:n-1;if(r>0){var s=r>=2?"-":"=",u=e.selection.length;u>o.lineLength&&(u=o.lineLength),e.endTag="\n";while(u--)e.endTag+=s}},y.doHorizontalRule=function(e,t){e.startTag="----------\n",e.selection="",e.skipLines(2,1,!0)}}(),function(){Markdown.local=Markdown.local||{},Markdown.local.cn={bold:"加粗 <strong> Ctrl+B",boldexample:"加粗文本",italic:"强调 <em> Ctrl+I",italicexample:"强调文本",link:"链接 <a> Ctrl+L",linkdescription:"添加链接",linkdialog:"<p><b>添加链接</b></p>",quote:"引用 <blockquote> Ctrl+Q",quoteexample:"引用",code:"代码，例如 <pre><code> Ctrl+K",codeexample:"在这里输入代码",image:"图片 <img> Ctrl+G",imagedescription:"插入图片描述",imagedialog:"<p><b>插入图片</b></p>",olist:"有序列表 <ol> Ctrl+O",ulist:"无序列表 <ul> Ctrl+U",litem:"列表",heading:"标题 <h1>/<h2> Ctrl+H",headingexample:"标题",hr:"分隔线 <hr> Ctrl+R",undo:"取消 - Ctrl+Z",redo:"重做 - Ctrl+Y",redomac:"重做 - Ctrl+Shift+Z",help:"Markdown Editing 帮助"}}(),function(e){"use strict";var t=function(t,n){var r=this,i={allowFreeEntries:!0,allowDuplicates:!1,ajaxConfig:{},autoSelect:!0,selectFirst:!1,queryParam:"query",beforeSend:function(){},cls:"",data:null,dataUrlParams:{},disabled:!1,disabledField:null,displayField:"name",editable:!0,expanded:!1,expandOnFocus:!1,groupBy:null,hideTrigger:!1,highlight:!0,id:null,infoMsgCls:"",inputCfg:{},invalidCls:"ms-inv",matchCase:!1,maxDropHeight:290,maxEntryLength:null,maxEntryRenderer:function(e){return"Please reduce your entry by "+e+" character"+(e>1?"s":"")},maxSuggestions:null,maxSelection:10,maxSelectionRenderer:function(e){return"You cannot choose more than "+e+" item"+(e>1?"s":"")},method:"POST",minChars:0,minCharsRenderer:function(e){return"Please type "+e+" more character"+(e>1?"s":"")},mode:"local",name:null,noSuggestionText:"No suggestions",placeholder:"Type or click here",renderer:null,required:!1,resultAsString:!1,resultAsStringDelimiter:",",resultsField:"results",selectionCls:"",selectionContainer:null,selectionPosition:"inner",selectionRenderer:null,selectionStacked:!1,sortDir:"asc",sortOrder:null,strictSuggest:!1,style:"",toggleOnClick:!1,typeDelay:400,useTabKey:!1,useCommaKey:!0,useZebraStyle:!1,value:null,valueField:"id",vregex:null,vtype:null},s=e.extend({},n),o=e.extend(!0,{},i,s);this.addToSelection=function(t,n){if(!o.maxSelection||u.length<o.maxSelection){e.isArray(t)||(t=[t]);var i=!1;e.each(t,function(t,n){if(o.allowDuplicates||e.inArray(n[o.valueField],r.getValue())===-1)u.push(n),i=!0}),i===!0&&(v._renderSelection(),this.empty(),n!==!0&&e(this).trigger("selectionchange",[this,this.getSelection()]))}this.input.attr("placeholder",o.selectionPosition==="inner"&&this.getValue().length>0?"":o.placeholder)},this.clear=function(e){this.removeFromSelection(u.slice(0),e)},this.collapse=function(){o.expanded===!0&&(this.combobox.detach(),o.expanded=!1,e(this).trigger("collapse",[this]))},this.disable=function(){this.container.addClass("ms-ctn-disabled"),o.disabled=!0,r.input.attr("disabled",!0)},this.empty=function(){this.input.val("")},this.enable=function(){this.container.removeClass("ms-ctn-disabled"),o.disabled=!1,r.input.attr("disabled",!1)},this.expand=function(){!o.expanded&&(this.input.val().length>=o.minChars||this.combobox.children().size()>0)&&(this.combobox.appendTo(this.container),v._processSuggestions(),o.expanded=!0,e(this).trigger("expand",[this]))},this.isDisabled=function(){return o.disabled},this.isValid=function(){var t=o.required===!1||u.length>0;return(o.vtype||o.vregex)&&e.each(u,function(e,n){t=t&&v._validateSingleItem(n[o.valueField])}),t},this.getDataUrlParams=function(){return o.dataUrlParams},this.getName=function(){return o.name},this.getSelection=function(){return u},this.getRawValue=function(){return r.input.val()},this.getValue=function(){return e.map(u,function(e){return e[o.valueField]})},this.removeFromSelection=function(t,n){e.isArray(t)||(t=[t]);var i=!1;e.each(t,function(t,n){var s=e.inArray(n[o.valueField],r.getValue());s>-1&&(u.splice(s,1),i=!0)}),i===!0&&(v._renderSelection(),n!==!0&&e(this).trigger("selectionchange",[this,this.getSelection()]),o.expandOnFocus&&r.expand(),o.expanded&&v._processSuggestions()),this.input.attr("placeholder",o.selectionPosition==="inner"&&this.getValue().length>0?"":o.placeholder)},this.getData=function(){return h},this.setData=function(e){o.data=e,v._processSuggestions()},this.setName=function(t){o.name=t,t&&(o.name+=t.indexOf("[]")>0?"":"[]"),r._valueContainer&&e.each(r._valueContainer.children(),function(e,t){t.name=o.name})},this.setSelection=function(e){this.clear(),this.addToSelection(e)},this.setValue=function(t){var n=[];e.each(t,function(t,r){var i=!1;e.each(h,function(e,t){if(t[o.valueField]==r)return n.push(t),i=!0,!1});if(!i)if(typeof r=="object")n.push(r);else{var s={};s[o.valueField]=r,s[o.displayField]=r,n.push(s)}}),n.length>0&&this.addToSelection(n)},this.setDataUrlParams=function(t){o.dataUrlParams=e.extend({},t)};var u=[],a=0,f,l=!1,c=null,h=[],p=!1,d={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESC:27,SPACE:32,UPARROW:38,DOWNARROW:40,COMMA:188},v={_displaySuggestions:function(t){r.combobox.show(),r.combobox.empty();var n=0,i=0;if(c===null)v._renderComboItems(t),n=a*t.length;else{for(var s in c)i+=1,e("<div/>",{"class":"ms-res-group",html:s}).appendTo(r.combobox),v._renderComboItems(c[s].items,!0);var u=r.combobox.find(".ms-res-group").outerHeight();if(u!==null){var f=i*u;n=a*t.length+f}else n=a*(t.length+i)}n<r.combobox.height()||n<=o.maxDropHeight?r.combobox.height(n):n>=r.combobox.height()&&n>o.maxDropHeight&&r.combobox.height(o.maxDropHeight),t.length===1&&o.autoSelect===!0&&r.combobox.children().filter(":not(.ms-res-item-disabled):last").addClass("ms-res-item-active"),o.selectFirst===!0&&r.combobox.children().filter(":not(.ms-res-item-disabled):first").addClass("ms-res-item-active");if(t.length===0&&r.getRawValue()!==""){var l=o.noSuggestionText.replace(/\{\{.*\}\}/,r.input.val());v._updateHelper(l),r.collapse()}o.allowFreeEntries===!1&&(t.length===0?(e(r.input).addClass(o.invalidCls),r.combobox.hide()):e(r.input).removeClass(o.invalidCls))},_getEntriesFromStringArray:function(t){var n=[];return e.each(t,function(t,r){var i={};i[o.displayField]=i[o.valueField]=e.trim(r),n.push(i)}),n},_highlightSuggestion:function(t){var n=r.input.val(),i=["^","$","*","+","?",".","(",")",":","!","|","{","}","[","]"];e.each(i,function(e,t){n=n.replace(t,"\\"+t)});if(n.length===0)return t;var s=o.matchCase===!0?"g":"gi";return t.replace(new RegExp("("+n+")(?!([^<]+)?>)",s),"<em>$1</em>")},_moveSelectedRow:function(e){o.expanded||r.expand();var t,n,i,s;t=r.combobox.find(".ms-res-item:not(.ms-res-item-disabled)"),e==="down"?n=t.eq(0):n=t.filter(":last"),i=r.combobox.find(".ms-res-item-active:not(.ms-res-item-disabled):first"),i.length>0&&(e==="down"?(n=i.nextAll(".ms-res-item:not(.ms-res-item-disabled)").first(),n.length===0&&(n=t.eq(0)),s=r.combobox.scrollTop(),r.combobox.scrollTop(0),n[0].offsetTop+n.outerHeight()>r.combobox.height()&&r.combobox.scrollTop(s+a)):(n=i.prevAll(".ms-res-item:not(.ms-res-item-disabled)").first(),n.length===0&&(n=t.filter(":last"),r.combobox.scrollTop(a*t.length)),n[0].offsetTop<r.combobox.scrollTop()&&r.combobox.scrollTop(r.combobox.scrollTop()-a))),t.removeClass("ms-res-item-active"),n.addClass("ms-res-item-active")},_processSuggestions:function(t){var n=null,i=t||o.data;if(i!==null){typeof i=="function"&&(i=i.call(r,r.getRawValue()));if(typeof i=="string"){e(r).trigger("beforeload",[r]);var s={};s[o.queryParam]=r.input.val();var u=e.extend(s,o.dataUrlParams);e.ajax(e.extend({type:o.method,url:i,data:u,beforeSend:o.beforeSend,success:function(t){n=typeof t=="string"?JSON.parse(t):t,v._processSuggestions(n),e(r).trigger("load",[r,n]),v._asyncValues&&(r.setValue(typeof v._asyncValues=="string"?JSON.parse(v._asyncValues):v._asyncValues),v._renderSelection(),delete v._asyncValues)},error:function(){throw"Could not reach server"}},o.ajaxConfig));return}i.length>0&&typeof i[0]=="string"?h=v._getEntriesFromStringArray(i):h=i[o.resultsField]||i;var a=o.mode==="remote"?h:v._sortAndTrim(h);v._displaySuggestions(v._group(a))}},_render:function(t){r.setName(o.name),r.container=e("<div/>",{"class":"ms-ctn form-control "+(o.resultAsString?"ms-as-string ":"")+o.cls+(e(t).hasClass("input-lg")?" input-lg":"")+(e(t).hasClass("input-sm")?" input-sm":"")+(o.disabled===!0?" ms-ctn-disabled":"")+(o.editable===!0?"":" ms-ctn-readonly")+(o.hideTrigger===!1?"":" ms-no-trigger"),style:o.style,id:o.id}),r.container.focus(e.proxy(m._onFocus,this)),r.container.blur(e.proxy(m._onBlur,this)),r.container.keydown(e.proxy(m._onKeyDown,this)),r.container.keyup(e.proxy(m._onKeyUp,this)),r.input=e("<input/>",e.extend({type:"text","class":o.editable===!0?"":" ms-input-readonly",readonly:!o.editable,placeholder:o.placeholder,disabled:o.disabled},o.inputCfg)),r.input.focus(e.proxy(m._onInputFocus,this)),r.input.click(e.proxy(m._onInputClick,this)),r.combobox=e("<div/>",{"class":"ms-res-ctn dropdown-menu"}).height(o.maxDropHeight),r.combobox.on("click","div.ms-res-item",e.proxy(m._onComboItemSelected,this)),r.combobox.on("mouseover","div.ms-res-item",e.proxy(m._onComboItemMouseOver,this)),o.selectionContainer?(r.selectionContainer=o.selectionContainer,e(r.selectionContainer).addClass("ms-sel-ctn")):r.selectionContainer=e("<div/>",{"class":"ms-sel-ctn"}),r.selectionContainer.click(e.proxy(m._onFocus,this)),o.selectionPosition==="inner"&&!o.selectionContainer?r.selectionContainer.append(r.input):r.container.append(r.input),r.helper=e("<span/>",{"class":"ms-helper "+o.infoMsgCls}),v._updateHelper(),r.container.append(r.helper),e(t).replaceWith(r.container);if(!o.selectionContainer)switch(o.selectionPosition){case"bottom":r.selectionContainer.insertAfter(r.container),o.selectionStacked===!0&&(r.selectionContainer.width(r.container.width()),r.selectionContainer.addClass("ms-stacked"));break;case"right":r.selectionContainer.insertAfter(r.container),r.container.css("float","left");break;default:r.container.append(r.selectionContainer)}o.hideTrigger===!1&&(r.trigger=e("<div/>",{"class":"ms-trigger",html:'<div class="ms-trigger-ico"></div>'}),r.trigger.click(e.proxy(m._onTriggerClick,this)),r.container.append(r.trigger)),e(window).resize(e.proxy(m._onWindowResized,this));if(o.value!==null||o.data!==null)typeof o.data=="string"?(v._asyncValues=o.value,v._processSuggestions()):(v._processSuggestions(),o.value!==null&&(r.setValue(o.value),v._renderSelection()));e("body").click(function(e){r.container.hasClass("ms-ctn-focus")&&r.container.has(e.target).length===0&&e.target.className.indexOf("ms-res-item")<0&&e.target.className.indexOf("ms-close-btn")<0&&r.container[0]!==e.target&&m._onBlur()}),o.expanded===!0&&(o.expanded=!1,r.expand())},_renderComboItems:function(t,n){var i=this,s="";e.each(t,function(t,r){var u=o.renderer!==null?o.renderer.call(i,r):r[o.displayField],a=o.disabledField!==null&&r[o.disabledField]===!0,f=e("<div/>",{"class":"ms-res-item "+(n?"ms-res-item-grouped ":"")+(a?"ms-res-item-disabled ":"")+(t%2===1&&o.useZebraStyle===!0?"ms-res-odd":""),html:o.highlight===!0?v._highlightSuggestion(u):u,"data-json":JSON.stringify(r)});s+=e("<div/>").append(f).html()}),r.combobox.append(s),a=r.combobox.find(".ms-res-item:first").outerHeight()},_renderSelection:function(){var t=this,n=0,i=0,s=[],a=o.resultAsString===!0&&!l;r.selectionContainer.find(".ms-sel-item").remove(),r._valueContainer!==undefined&&r._valueContainer.remove(),e.each(u,function(n,r){var i,f,l=o.selectionRenderer!==null?o.selectionRenderer.call(t,r):r[o.displayField],c=v._validateSingleItem(r[o.displayField])?"":" ms-sel-invalid";a===!0?i=e("<div/>",{"class":"ms-sel-item ms-sel-text "+o.selectionCls+c,html:l+(n===u.length-1?"":o.resultAsStringDelimiter)}).data("json",r):(i=e("<div/>",{"class":"ms-sel-item "+o.selectionCls+c,html:l}).data("json",r),o.disabled===!1&&(f=e("<span/>",{"class":"ms-close-btn"}).data("json",r).appendTo(i),f.click(e.proxy(m._onTagTriggerClick,t)))),s.push(i)}),r.selectionContainer.prepend(s),r._valueContainer=e("<div/>",{style:"display: none;"}),e.each(r.getValue(),function(t,n){var i=e("<input/>",{type:"hidden",name:o.name,value:n});i.appendTo(r._valueContainer)}),r._valueContainer.appendTo(r.selectionContainer),o.selectionPosition==="inner"&&!o.selectionContainer&&(r.input.width(0),i=r.input.offset().left-r.selectionContainer.offset().left,n=r.container.width()-i-42,r.input.width(n)),u.length===o.maxSelection?v._updateHelper(o.maxSelectionRenderer.call(this,u.length)):r.helper.hide()},_selectItem:function(e){o.maxSelection===1&&(u=[]),r.addToSelection(e.data("json")),e.removeClass("ms-res-item-active"),(o.expandOnFocus===!1||u.length===o.maxSelection)&&r.collapse(),l?l&&(o.expandOnFocus||p)&&(v._processSuggestions(),p&&r.expand()):r.input.focus()},_sortAndTrim:function(t){var n=r.getRawValue(),i=[],s=[],u=r.getValue();return n.length>0?e.each(t,function(e,t){var r=t[o.displayField];(o.matchCase===!0&&r.indexOf(n)>-1||o.matchCase===!1&&r.toLowerCase().indexOf(n.toLowerCase())>-1)&&(o.strictSuggest===!1||r.toLowerCase().indexOf(n.toLowerCase())===0)&&i.push(t)}):i=t,e.each(i,function(t,n){(o.allowDuplicates||e.inArray(n[o.valueField],u)===-1)&&s.push(n)}),o.sortOrder!==null&&s.sort(function(e,t){return e[o.sortOrder]<t[o.sortOrder]?o.sortDir==="asc"?-1:1:e[o.sortOrder]>t[o.sortOrder]?o.sortDir==="asc"?1:-1:0}),o.maxSuggestions&&o.maxSuggestions>0&&(s=s.slice(0,o.maxSuggestions)),s},_group:function(t){return o.groupBy!==null&&(c={},e.each(t,function(e,t){var n=o.groupBy.indexOf(".")>-1?o.groupBy.split("."):o.groupBy,r=t[o.groupBy];if(typeof n!="string"){r=t;while(n.length>0)r=r[n.shift()]}c[r]===undefined?c[r]={title:r,items:[t]}:c[r].items.push(t)})),t},_updateHelper:function(e){r.helper.html(e),r.helper.is(":visible")||r.helper.fadeIn()},_validateSingleItem:function(e){if(o.vregex!==null&&o.vregex instanceof RegExp)return o.vregex.test(e);if(o.vtype!==null)switch(o.vtype){case"alpha":return/^[a-zA-Z_]+$/.test(e);case"alphanum":return/^[a-zA-Z0-9_]+$/.test(e);case"email":return/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/.test(e);case"url":return/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i.test(e);case"ipaddress":return/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(e)}return!0}},m={_onBlur:function(){r.container.removeClass("ms-ctn-focus"),r.collapse(),l=!1;if(r.getRawValue()!==""&&o.allowFreeEntries===!0){var t={};t[o.displayField]=t[o.valueField]=r.getRawValue().trim(),r.addToSelection(t)}v._renderSelection(),r.isValid()===!1?r.container.addClass(o.invalidCls):r.input.val()!==""&&o.allowFreeEntries===!1&&(r.empty(),v._updateHelper("")),e(r).trigger("blur",[r])},_onComboItemMouseOver:function(t){var n=e(t.currentTarget);n.hasClass("ms-res-item-disabled")||(r.combobox.children().removeClass("ms-res-item-active"),n.addClass("ms-res-item-active"))},_onComboItemSelected:function(t){var n=e(t.currentTarget);n.hasClass("ms-res-item-disabled")||v._selectItem(e(t.currentTarget))},_onFocus:function(){r.input.focus()},_onInputClick:function(){r.isDisabled()===!1&&l&&o.toggleOnClick===!0&&(o.expanded?r.collapse():r.expand())},_onInputFocus:function(){if(r.isDisabled()===!1&&!l){l=!0,r.container.addClass("ms-ctn-focus"),r.container.removeClass(o.invalidCls);var t=r.getRawValue().length;o.expandOnFocus===!0&&r.expand(),u.length===o.maxSelection?v._updateHelper(o.maxSelectionRenderer.call(this,u.length)):t<o.minChars&&v._updateHelper(o.minCharsRenderer.call(this,o.minChars-t)),v._renderSelection(),e(r).trigger("focus",[r])}},_onKeyDown:function(t){var n=r.combobox.find(".ms-res-item-active:not(.ms-res-item-disabled):first"),i=r.input.val();e(r).trigger("keydown",[r,t]);if(t.keyCode===d.TAB&&(o.useTabKey===!1||o.useTabKey===!0&&n.length===0&&r.input.val().length===0)){m._onBlur();return}switch(t.keyCode){case d.BACKSPACE:i.length===0&&r.getSelection().length>0&&o.selectionPosition==="inner"&&(u.pop(),v._renderSelection(),e(r).trigger("selectionchange",[r,r.getSelection()]),r.input.attr("placeholder",o.selectionPosition==="inner"&&r.getValue().length>0?"":o.placeholder),r.input.focus(),t.preventDefault());break;case d.TAB:case d.ESC:t.preventDefault();break;case d.ENTER:(i!==""||o.expanded)&&t.preventDefault();break;case d.COMMA:o.useCommaKey===!0&&t.preventDefault();break;case d.CTRL:p=!0;break;case d.DOWNARROW:t.preventDefault(),v._moveSelectedRow("down");break;case d.UPARROW:t.preventDefault(),v._moveSelectedRow("up");break;default:u.length===o.maxSelection&&t.preventDefault()}},_onKeyUp:function(t){var n=r.getRawValue(),i=e.trim(r.input.val()).length>0&&(!o.maxEntryLength||e.trim(r.input.val()).length<=o.maxEntryLength),s,a={};e(r).trigger("keyup",[r,t]),clearTimeout(f),t.keyCode===d.ESC&&o.expanded&&r.combobox.hide();if(t.keyCode===d.TAB&&o.useTabKey===!1||t.keyCode>d.ENTER&&t.keyCode<d.SPACE){t.keyCode===d.CTRL&&(p=!1);return}switch(t.keyCode){case d.UPARROW:case d.DOWNARROW:t.preventDefault();break;case d.ENTER:case d.TAB:case d.COMMA:if(t.keyCode!==d.COMMA||o.useCommaKey===!0){t.preventDefault();if(o.expanded===!0){s=r.combobox.find(".ms-res-item-active:not(.ms-res-item-disabled):first");if(s.length>0){v._selectItem(s);return}}i===!0&&o.allowFreeEntries===!0&&(a[o.displayField]=a[o.valueField]=n.trim(),r.addToSelection(a),r.collapse(),r.input.focus());break};default:u.length===o.maxSelection?v._updateHelper(o.maxSelectionRenderer.call(this,u.length)):n.length<o.minChars?(v._updateHelper(o.minCharsRenderer.call(this,o.minChars-n.length)),o.expanded===!0&&r.collapse()):o.maxEntryLength&&n.length>o.maxEntryLength?(v._updateHelper(o.maxEntryRenderer.call(this,n.length-o.maxEntryLength)),o.expanded===!0&&r.collapse()):(r.helper.hide(),o.minChars<=n.length&&(f=setTimeout(function(){o.expanded===!0?v._processSuggestions():r.expand()},o.typeDelay)))}},_onTagTriggerClick:function(t){r.removeFromSelection(e(t.currentTarget).data("json"))},_onTriggerClick:function(){if(r.isDisabled()===!1&&(o.expandOnFocus!==!0||u.length!==o.maxSelection)){e(r).trigger("triggerclick",[r]);if(o.expanded===!0)r.collapse();else{var t=r.getRawValue().length;t>=o.minChars?(r.input.focus(),r.expand()):v._updateHelper(o.minCharsRenderer.call(this,o.minChars-t))}}},_onWindowResized:function(){v._renderSelection()}};t!==null&&v._render(t)};e.fn.magicSuggest=function(n){var r=e(this);return r.size()===1&&r.data("magicSuggest")?r.data("magicSuggest"):(r.each(function(r){var i=e(this);if(i.data("magicSuggest"))return;this.nodeName.toLowerCase()==="select"&&(n.data=[],n.value=[],e.each(this.children,function(t,r){r.nodeName&&r.nodeName.toLowerCase()==="option"&&(n.data.push({id:r.value,name:r.text}),e(r).attr("selected")&&n.value.push(r.value))}));var s={};e.each(this.attributes,function(e,t){s[t.name]=t.name==="value"&&t.value!==""?JSON.parse(t.value):t.value});var o=new t(this,e.extend([],e.fn.magicSuggest.defaults,n,s));i.data("magicSuggest",o),o.container.data("magicSuggest",o)}),r.size()===1?r.data("magicSuggest"):r)},e.fn.magicSuggest.defaults={}}(jQuery),function(){var e=function(){typeof String.prototype.format!="function"&&(String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;++t)e=e.replace(new RegExp("\\{"+t+"\\}","g"),arguments[t]);return e}),typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})};typeof module!="undefined"?module.exports=e:e()}(),function(e,t,n){"use strict";var r,i;e.uaMatch=function(e){e=e.toLowerCase();var t=/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n=/(ipad)/.exec(e)||/(iphone)/.exec(e)||/(android)/.exec(e)||/(windows phone)/.exec(e)||/(win)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/i.exec(e)||[];return{browser:t[3]||t[1]||"",version:t[2]||"0",platform:n[0]||""}},r=e.uaMatch(t.navigator.userAgent),i={},r.browser&&(i[r.browser]=!0,i.version=r.version,i.versionNumber=parseInt(r.version)),r.platform&&(i[r.platform]=!0);if(i.android||i.ipad||i.iphone||i["windows phone"])i.mobile=!0;if(i.cros||i.mac||i.linux||i.win)i.desktop=!0;if(i.chrome||i.opr||i.safari)i.webkit=!0;if(i.rv){var s="msie";r.browser=s,i[s]=!0}if(i.opr){var o="opera";r.browser=o,i[o]=!0}if(i.safari&&i.android){var u="android";r.browser=u,i[u]=!0}i.name=r.browser,i.platform=r.platform,e.browser=i}(jQuery,window),function(e){e.fn.view=function(t,n){n=n||{};var r=n.formatter,i=function(){var n=this,i=e(n),s=n.tagName,o=i.attr("data-bind"),u=t[o];r&&(u=r.call(n,u)),typeof u!="undefined"&&(s=="INPUT"||s=="TEXTAREA"||s=="SELECT"?i.val(u):i.html(u))},s=function(){var n=this,r=e(n),i=r.attr("data-show"),s=r.attr("data-show")||r.attr("data-hide")||"",o=t[s];i?o?r.show():r.hide():o?r.hide():r.show()};return this.each(function(){var n=this,r=e(n);typeof t=="object"&&(r.find("[data-bind]").each(i),r.find("[data-show],[data-hide]").each(s))})}}(jQuery),function(e,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():e.NProgress=t()}(this,function(){function n(e,t,n){return e<t?t:e>n?n:e}function r(e){return(-1+e)*100}function i(e,n,i){var s;return t.positionUsing==="translate3d"?s={transform:"translate3d("+r(e)+"%,0,0)"}:t.positionUsing==="translate"?s={transform:"translate("+r(e)+"%,0)"}:s={"margin-left":r(e)+"%"},s.transition="all "+n+"ms "+i,s}function u(e,t){var n=typeof e=="string"?e:l(e);return n.indexOf(" "+t+" ")>=0}function a(e,t){var n=l(e),r=n+t;if(u(n,t))return;e.className=r.substring(1)}function f(e,t){var n=l(e),r;if(!u(e,t))return;r=n.replace(" "+t+" "," "),e.className=r.substring(1,r.length-1)}function l(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function c(e){e&&e.parentNode&&e.parentNode.removeChild(e)}var e={};e.version="0.1.6";var t=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(e){var n,r;for(n in e)r=e[n],r!==undefined&&e.hasOwnProperty(n)&&(t[n]=r);return this},e.status=null,e.set=function(r){var u=e.isStarted();r=n(r,t.minimum,1),e.status=r===1?null:r;var a=e.render(!u),f=a.querySelector(t.barSelector),l=t.speed,c=t.easing;return a.offsetWidth,s(function(n){t.positionUsing===""&&(t.positionUsing=e.getPositioningCSS()),o(f,i(r,l,c)),r===1?(o(a,{transition:"none",opacity:1}),a.offsetWidth,setTimeout(function(){o(a,{transition:"all "+l+"ms linear",opacity:0}),setTimeout(function(){e.remove(),n()},l)},l)):setTimeout(n,l)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var n=function(){setTimeout(function(){if(!e.status)return;e.trickle(),n()},t.trickleSpeed)};return t.trickle&&n(),this},e.done=function(t){return!t&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(t){var r=e.status;return r?(typeof t!="number"&&(t=(1-r)*n(Math.random()*r,.1,.95)),r=n(r+t,0,.994),e.set(r)):e.start()},e.trickle=function(){return e.inc(Math.random()*t.trickleRate)},function(){var t=0,n=0;e.promise=function(r){return!r||r.state()=="resolved"?this:(n==0&&e.start(),t++,n++,r.always(function(){n--,n==0?(t=0,e.done()):e.set((t-n)/t)}),this)}}(),e.render=function(n){if(e.isRendered())return document.getElementById("nprogress");a(document.documentElement,"nprogress-busy");var i=document.createElement("div");i.id="nprogress",i.innerHTML=t.template;var s=i.querySelector(t.barSelector),u=n?"-100":r(e.status||0),f=document.querySelector(t.parent),l;return o(s,{transition:"all 0 linear",transform:"translate3d("+u+"%,0,0)"}),t.showSpinner||(l=i.querySelector(t.spinnerSelector),l&&c(l)),f!=document.body&&a(f,"nprogress-custom-parent"),f.appendChild(i),i},e.remove=function(){f(document.documentElement,"nprogress-busy"),f(document.querySelector(t.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&c(e)},e.isRendered=function(){return!!document.getElementById("nprogress")},e.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var s=function(){function t(){var n=e.shift();n&&n(t)}var e=[];return function(n){e.push(n),e.length==1&&t()}}(),o=function(){function n(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function r(t){var n=document.body.style;if(t in n)return t;var r=e.length,i=t.charAt(0).toUpperCase()+t.slice(1),s;while(r--){s=e[r]+i;if(s in n)return s}return t}function i(e){return e=n(e),t[e]||(t[e]=r(e))}function s(e,t,n){t=i(t),e.style[t]=n}var e=["Webkit","O","Moz","ms"],t={};return function(e,t){var n=arguments,r,i;if(n.length==2)for(r in t)i=t[r],i!==undefined&&t.hasOwnProperty(r)&&s(e,r,i);else s(e,n[1],n[2])}}();return e}),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof exports=="object"?e(require("jquery")):e(jQuery)}(function(e,t){function n(){return new Date(Date.UTC.apply(Date,arguments))}function r(){var e=new Date;return n(e.getFullYear(),e.getMonth(),e.getDate())}function i(e,t){return e.getUTCFullYear()===t.getUTCFullYear()&&e.getUTCMonth()===t.getUTCMonth()&&e.getUTCDate()===t.getUTCDate()}function s(e){return function(){return this[e].apply(this,arguments)}}function o(e){return e&&!isNaN(e.getTime())}function l(t,n){function u(e,t){return t.toLowerCase()}var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])");n=new RegExp("^"+n.toLowerCase());for(var a in r)n.test(a)&&(s=a.replace(o,u),i[s]=r[a]);return i}function c(t){var n={};if(!m[t]){t=t.split("-")[0];if(!m[t])return}var r=m[t];return e.each(v,function(e,t){t in r&&(n[t]=r[t])}),n}var u=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){var t=e&&e.valueOf();for(var n=0,r=this.length;n<r;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){if(!t)return;e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t)},clear:function(){this.length=0},copy:function(){var e=new u;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),a=function(t,n){this._process_options(n),this.dates=new u,this.viewDate=this.o.defaultViewDate,this.focusDate=null,this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.hasClass("date")?this.element.find(".add-on, .input-group-addon, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.picker=e(g.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot .today, tfoot .clear").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.setDaysOfWeekHighlighted(this.o.daysOfWeekHighlighted),this.setDatesDisabled(this.o.datesDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};a.prototype={constructor:a,_process_options:function(i){this._o=e.extend({},this._o,i);var s=this.o=e.extend({},this._o),o=s.language;m[o]||(o=o.split("-")[0],m[o]||(o=d.language)),s.language=o;switch(s.startView){case 2:case"decade":s.startView=2;break;case 1:case"year":s.startView=1;break;default:s.startView=0}switch(s.minViewMode){case 1:case"months":s.minViewMode=1;break;case 2:case"years":s.minViewMode=2;break;default:s.minViewMode=0}switch(s.maxViewMode){case 0:case"days":s.maxViewMode=0;break;case 1:case"months":s.maxViewMode=1;break;default:s.maxViewMode=2}s.startView=Math.min(s.startView,s.maxViewMode),s.startView=Math.max(s.startView,s.minViewMode),s.multidate!==!0&&(s.multidate=Number(s.multidate)||!1,s.multidate!==!1&&(s.multidate=Math.max(0,s.multidate))),s.multidateSeparator=String(s.multidateSeparator),s.weekStart%=7,s.weekEnd=(s.weekStart+6)%7;var u=g.parseFormat(s.format);s.startDate!==-Infinity&&(s.startDate?s.startDate instanceof Date?s.startDate=this._local_to_utc(this._zero_time(s.startDate)):s.startDate=g.parseDate(s.startDate,u,s.language):s.startDate=-Infinity),s.endDate!==Infinity&&(s.endDate?s.endDate instanceof Date?s.endDate=this._local_to_utc(this._zero_time(s.endDate)):s.endDate=g.parseDate(s.endDate,u,s.language):s.endDate=Infinity),s.daysOfWeekDisabled=s.daysOfWeekDisabled||[],e.isArray(s.daysOfWeekDisabled)||(s.daysOfWeekDisabled=s.daysOfWeekDisabled.split(/[,\s]*/)),s.daysOfWeekDisabled=e.map(s.daysOfWeekDisabled,function(e){return parseInt(e,10)}),s.daysOfWeekHighlighted=s.daysOfWeekHighlighted||[],e.isArray(s.daysOfWeekHighlighted)||(s.daysOfWeekHighlighted=s.daysOfWeekHighlighted.split(/[,\s]*/)),s.daysOfWeekHighlighted=e.map(s.daysOfWeekHighlighted,function(e){return parseInt(e,10)}),s.datesDisabled=s.datesDisabled||[];if(!e.isArray(s.datesDisabled)){var a=[];a.push(g.parseDate(s.datesDisabled,u,s.language)),s.datesDisabled=a}s.datesDisabled=e.map(s.datesDisabled,function(e){return g.parseDate(e,u,s.language)});var f=String(s.orientation).toLowerCase().split(/\s+/g),l=s.orientation.toLowerCase();f=e.grep(f,function(e){return/^auto|left|right|top|bottom$/.test(e)}),s.orientation={x:"auto",y:"auto"};if(!!l&&l!=="auto")if(f.length===1)switch(f[0]){case"top":case"bottom":s.orientation.y=f[0];break;case"left":case"right":s.orientation.x=f[0]}else l=e.grep(f,function(e){return/^left|right$/.test(e)}),s.orientation.x=l[0]||"auto",l=e.grep(f,function(e){return/^top|bottom$/.test(e)}),s.orientation.y=l[0]||"auto";if(s.defaultViewDate){var c=s.defaultViewDate.year||(new Date).getFullYear(),h=s.defaultViewDate.month||0,p=s.defaultViewDate.day||1;s.defaultViewDate=n(c,h,p)}else s.defaultViewDate=r();s.showOnFocus=s.showOnFocus!==t?s.showOnFocus:!0,s.zIndexOffset=s.zIndexOffset!==t?s.zIndexOffset:10},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var n=0,r,i,s;n<e.length;n++)r=e[n][0],e[n].length===2?(i=t,s=e[n][1]):e[n].length===3&&(i=e[n][1],s=e[n][2]),r.on(s,i)},_unapplyEvents:function(e){for(var n=0,r,i,s;n<e.length;n++)r=e[n][0],e[n].length===2?(s=t,i=e[n][1]):e[n].length===3&&(s=e[n][1],i=e[n][2]),r.off(i,s)},_buildEvents:function(){var t={keyup:e.proxy(function(t){e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])===-1&&this.update()},this),keydown:e.proxy(this.keydown,this),paste:e.proxy(this.paste,this)};this.o.showOnFocus===!0&&(t.focus=e.proxy(this.show,this)),this.isInput?this._events=[[this.element,t]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),t],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":e.proxy(function(e){this.update(e.date)},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.picker.hasClass("datepicker-inline")||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.dates.get(-1),i=this._utc_to_local(r);this.element.trigger({type:t,date:i,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){arguments.length===0?(e=this.dates.length-1,t=this.o.format):typeof e=="string"&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return g.formatDate(n,t,this.o.language)},this)})},show:function(){if(this.element.attr("readonly")&&this.o.enableOnReadonly===!1)return;return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&e(this.element).blur(),this},hide:function(){return this.isInline?this:this.picker.is(":visible")?(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"),this):this},remove:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var n;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&e.inArray("text/plain",t.originalEvent.clipboardData.types)!==-1)n=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;n=window.clipboardData.getData("Text")}this.setDate(n),this.update(),t.preventDefault()},_utc_to_local:function(e){return e&&new Date(e.getTime()+e.getTimezoneOffset()*6e4)},_local_to_utc:function(e){return e&&new Date(e.getTime()-e.getTimezoneOffset()*6e4)},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var e=this.dates.get(-1);return typeof e!="undefined"?new Date(e):null},clearDates:function(){var e;this.isInput?e=this.element:this.component&&(e=this.element.find("input")),e&&e.val(""),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue(),this},setDate:s("setDates"),setUTCDate:s("setUTCDates"),setValue:function(){var e=this.getFormattedDate();return this.isInput?this.element.val(e):this.component&&this.element.find("input").val(e),this},getFormattedDate:function(n){n===t&&(n=this.o.format);var r=this.o.language;return e.map(this.dates,function(e){return g.formatDate(e,n,r)}).join(this.o.multidateSeparator)},setStartDate:function(e){return this._process_options({startDate:e}),this.update(),this.updateNavArrows(),this},setEndDate:function(e){return this._process_options({endDate:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(e){return this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows(),this},setDaysOfWeekHighlighted:function(e){return this._process_options({daysOfWeekHighlighted:e}),this.update(),this},setDatesDisabled:function(e){this._process_options({datesDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(this.isInline)return this;var t=this.picker.outerWidth(),n=this.picker.outerHeight(),r=10,i=e(this.o.container),s=i.width(),o=i.scrollTop(),u=i.offset(),a=[];this.element.parents().each(function(){var t=e(this).css("z-index");t!=="auto"&&t!==0&&a.push(parseInt(t))});var f=Math.max.apply(Math,a)+this.o.zIndexOffset,l=this.component?this.component.parent().offset():this.element.offset(),c=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),h=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),p=l.left-u.left,d=l.top-u.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),this.o.orientation.x!=="auto"?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),this.o.orientation.x==="right"&&(p-=t-h)):l.left<0?(this.picker.addClass("datepicker-orient-left"),p-=l.left-r):p+t>s?(this.picker.addClass("datepicker-orient-right"),p=l.left+h-t):this.picker.addClass("datepicker-orient-left");var v=this.o.orientation.y,m;v==="auto"&&(m=-o+d-n,v=m<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+v),v==="top"?d-=n+parseInt(this.picker.css("padding-top")):d+=c;if(this.o.rtl){var g=s-(p+h);this.picker.css({top:d,right:g,zIndex:f})}else this.picker.css({top:d,left:p,zIndex:f});return this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var t=this.dates.copy(),n=[],r=!1;return arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),r=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n&&this.o.multidate?n=n.split(this.o.multidateSeparator):n=[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return g.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=this.o.defaultViewDate,r?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill(),this.element.change(),this},fillDow:function(){var e=this.o.weekStart,t="<tr>";this.o.calendarWeeks&&(this.picker.find(".datepicker-days .datepicker-switch").attr("colspan",function(e,t){return parseInt(t)+1}),t+='<th class="cw">&#160;</th>');while(e<this.o.weekStart+7)t+='<th class="dow">'+m[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12)e+='<span class="month">'+m[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){!t||!t.length?delete this.range:this.range=e.map(t,function(e){return e.valueOf()}),this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),o=new Date;return t.getUTCFullYear()<r||t.getUTCFullYear()===r&&t.getUTCMonth()<s?n.push("old"):(t.getUTCFullYear()>r||t.getUTCFullYear()===r&&t.getUTCMonth()>s)&&n.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===o.getFullYear()&&t.getUTCMonth()===o.getMonth()&&t.getUTCDate()===o.getDate()&&n.push("today"),this.dates.contains(t)!==-1&&n.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1)&&n.push("disabled"),e.inArray(t.getUTCDay(),this.o.daysOfWeekHighlighted)!==-1&&n.push("highlighted"),this.o.datesDisabled.length>0&&e.grep(this.o.datesDisabled,function(e){return i(t,e)}).length>0&&n.push("disabled","disabled-date"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),e.inArray(t.valueOf(),this.range)!==-1&&n.push("selected"),t.valueOf()===this.range[0]&&n.push("range-start"),t.valueOf()===this.range[this.range.length-1]&&n.push("range-end")),n},fill:function(){var r=new Date(this.viewDate),i=r.getUTCFullYear(),s=r.getUTCMonth(),o=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,u=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,f=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,l=m[this.o.language].today||m.en.today||"",c=m[this.o.language].clear||m.en.clear||"",h=m[this.o.language].titleFormat||m.en.titleFormat,p;if(isNaN(i)||isNaN(s))return;this.picker.find(".datepicker-days thead .datepicker-switch").text(g.formatDate(new n(i,s),h,this.o.language)),this.picker.find("tfoot .today").text(l).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot .clear").text(c).toggle(this.o.clearBtn!==!1),this.picker.find("thead .datepicker-title").text(this.o.title).toggle(this.o.title!==""),this.updateNavArrows(),this.fillMonths();var d=n(i,s-1,28),v=g.getDaysInMonth(d.getUTCFullYear(),d.getUTCMonth());d.setUTCDate(v),d.setUTCDate(v-(d.getUTCDay()-this.o.weekStart+7)%7);var y=new Date(d);d.getUTCFullYear()<100&&y.setUTCFullYear(d.getUTCFullYear()),y.setUTCDate(y.getUTCDate()+42),y=y.valueOf();var b=[],w;while(d.valueOf()<y){if(d.getUTCDay()===this.o.weekStart){b.push("<tr>");if(this.o.calendarWeeks){var E=new Date(+d+(this.o.weekStart-d.getUTCDay()-7)%7*864e5),S=new Date(Number(E)+(11-E.getUTCDay())%7*864e5),x=new Date(Number(x=n(S.getUTCFullYear(),0,1))+(11-x.getUTCDay())%7*864e5),T=(S-x)/864e5/7+1;b.push('<td class="cw">'+T+"</td>")}}w=this.getClassNames(d),w.push("day");if(this.o.beforeShowDay!==e.noop){var N=this.o.beforeShowDay(this._utc_to_local(d));N===t?N={}:typeof N=="boolean"?N={enabled:N}:typeof N=="string"&&(N={classes:N}),N.enabled===!1&&w.push("disabled"),N.classes&&(w=w.concat(N.classes.split(/\s+/))),N.tooltip&&(p=N.tooltip)}w=e.unique(w),b.push('<td class="'+w.join(" ")+'"'+(p?' title="'+p+'"':"")+">"+d.getUTCDate()+"</td>"),p=null,d.getUTCDay()===this.o.weekEnd&&b.push("</tr>"),d.setUTCDate(d.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(b.join(""));var C=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?"Months":i).end().find("span").removeClass("active");e.each(this.dates,function(e,t){t.getUTCFullYear()===i&&C.eq(t.getUTCMonth()).addClass("active")}),(i<o||i>a)&&C.addClass("disabled"),i===o&&C.slice(0,u).addClass("disabled"),i===a&&C.slice(f+1).addClass("disabled");if(this.o.beforeShowMonth!==e.noop){var k=this;e.each(C,function(t,n){if(!e(n).hasClass("disabled")){var r=new Date(i,t,1),s=k.o.beforeShowMonth(r);s===!1&&e(n).addClass("disabled")}})}b="",i=parseInt(i/10,10)*10;var L=this.picker.find(".datepicker-years").find(".datepicker-switch").text(i+"-"+(i+9)).end().find("td");i-=1;var A=e.map(this.dates,function(e){return e.getUTCFullYear()}),O;for(var M=-1;M<11;M++){O=["year"],p=null,M===-1?O.push("old"):M===10&&O.push("new"),e.inArray(i,A)!==-1&&O.push("active"),(i<o||i>a)&&O.push("disabled");if(this.o.beforeShowYear!==e.noop){var _=this.o.beforeShowYear(new Date(i,0,1));_===t?_={}:typeof _=="boolean"?_={enabled:_}:typeof _=="string"&&(_={classes:_}),_.enabled===!1&&O.push("disabled"),_.classes&&(O=O.concat(_.classes.split(/\s+/))),_.tooltip&&(p=_.tooltip)}b+='<span class="'+O.join(" ")+'"'+(p?' title="'+p+'"':"")+">"+i+"</span>",i+=1}L.html(b)},updateNavArrows:function(){if(!this._allow_update)return;var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()||this.o.maxViewMode<2?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},click:function(t){t.preventDefault(),t.stopPropagation();var r=e(t.target).closest("span, td, th"),i,s,o;if(r.length===1)switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var u=g.modes[this.viewMode].navStep*(r[0].className==="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,u),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,u),this.viewMode===1&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var a=new Date;a=n(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var f=this.o.todayBtn==="linked"?null:"view";this._setDate(a,f);break;case"clear":this.clearDates()}break;case"span":r.hasClass("disabled")||(this.viewDate.setUTCDate(1),r.hasClass("month")?(o=1,s=r.parent().find("span").index(r),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(s),this._trigger("changeMonth",this.viewDate),this.o.minViewMode===1?(this._setDate(n(i,s,o)),this.showMode()):this.showMode(-1)):(o=1,s=0,i=parseInt(r.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),this.o.minViewMode===2&&this._setDate(n(i,s,o)),this.showMode(-1)),this.fill());break;case"td":r.hasClass("day")&&!r.hasClass("disabled")&&(o=parseInt(r.text(),10)||1,i=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),r.hasClass("old")?s===0?(s=11,i-=1):s-=1:r.hasClass("new")&&(s===11?(s=0,i+=1):s+=1),this._setDate(n(i,s,o)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);e||this.dates.clear(),t!==-1?(this.o.multidate===!0||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(t):this.o.multidate===!1?(this.dates.clear(),this.dates.push(e)):this.dates.push(e);if(typeof this.o.multidate=="number")while(this.dates.length>this.o.multidate)this.dates.remove(0)},_setDate:function(e,t){(!t||t==="date")&&this._toggle_multidate(e&&new Date(e));if(!t||t==="view")this.viewDate=e&&new Date(e);this.fill(),this.setValue(),(!t||t!=="view")&&this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),this.o.autoclose&&(!t||t==="date")&&this.hide()},moveMonth:function(e,t){if(!o(e))return this.o.defaultViewDate;if(!t)return e;var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),u,a;t=t>0?1:-1;if(s===1){a=t===-1?function(){return n.getUTCMonth()===i}:function(){return n.getUTCMonth()!==u},u=i+t,n.setUTCMonth(u);if(u<0||u>11)u=(u+12)%12}else{for(var f=0;f<s;f++)n=this.moveMonth(n,t);u=n.getUTCMonth(),n.setUTCDate(r),a=function(){return u!==n.getUTCMonth()}}while(a())n.setUTCDate(--r),n.setUTCMonth(u);return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(!this.picker.is(":visible")){if(e.keyCode===40||e.keyCode===27)this.show(),e.stopPropagation();return}var t=!1,n,i,s,o=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault(),e.stopPropagation();break;case 37:case 39:if(!this.o.keyboardNavigation)break;n=e.keyCode===37?-1:1,e.ctrlKey?(i=this.moveYear(this.dates.get(-1)||r(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(i=this.moveMonth(this.dates.get(-1)||r(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||r()),i.setUTCDate(i.getUTCDate()+n),s=new Date(o),s.setUTCDate(o.getUTCDate()+n)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;n=e.keyCode===38?-1:1,e.ctrlKey?(i=this.moveYear(this.dates.get(-1)||r(),n),s=this.moveYear(o,n),this._trigger("changeYear",this.viewDate)):e.shiftKey?(i=this.moveMonth(this.dates.get(-1)||r(),n),s=this.moveMonth(o,n),this._trigger("changeMonth",this.viewDate)):(i=new Date(this.dates.get(-1)||r()),i.setUTCDate(i.getUTCDate()+n*7),s=new Date(o),s.setUTCDate(o.getUTCDate()+n*7)),this.dateWithinRange(s)&&(this.focusDate=this.viewDate=s,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:if(!this.o.forceParse)break;o=this.focusDate||this.dates.get(-1)||this.viewDate,this.o.keyboardNavigation&&(this._toggle_multidate(o),t=!0),this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.cancelBubble=!0,this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(t){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var u;this.isInput?u=this.element:this.component&&(u=this.element.find("input")),u&&u.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,this.viewMode+e))),this.picker.children("div").hide().filter(".datepicker-"+g.modes[this.viewMode].clsName).show(),this.updateNavArrows()}};var f=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,p.call(e(this.inputs),n).on("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};f.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(this.updating)return;this.updating=!0;var n=e(t.target).data("datepicker");if(typeof n=="undefined")return;var r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=i-1,o=i+1,u=this.inputs.length;if(i===-1)return;e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(r)});if(r<this.dates[s])while(s>=0&&r<this.dates[s])this.pickers[s--].setUTCDate(r);else if(r>this.dates[o])while(o<u&&r>this.dates[o])this.pickers[o++].setUTCDate(r);this.updateDates(),delete this.updating},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var h=e.fn.datepicker,p=function(n){var r=Array.apply(null,arguments);r.shift();var i;this.each(function(){var t=e(this),s=t.data("datepicker"),o=typeof n=="object"&&n;if(!s){var u=l(this,"date"),h=e.extend({},d,u,o),p=c(h.language),v=e.extend({},d,p,u,o);if(t.hasClass("input-daterange")||v.inputs){var m={inputs:v.inputs||t.find("input").toArray()};t.data("datepicker",s=new f(this,e.extend(v,m)))}else t.data("datepicker",s=new a(this,v))}typeof n=="string"&&typeof s[n]=="function"&&(i=s[n].apply(s,r))});if(i===t||i instanceof a||i instanceof f)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+n+" function)");return i};e.fn.datepicker=p;var d=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,beforeShowMonth:e.noop,beforeShowYear:e.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:Infinity,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:2,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-Infinity,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,container:"body",immediateUpdates:!1,title:""},v=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=a;var m=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}},g={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,g.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){if(typeof e.toValue=="function"&&typeof e.toDisplay=="function")return e;var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(r,i,s){function w(){var e=this.slice(0,u[c].length),t=u[c].slice(0,e.length);return e.toLowerCase()===t.toLowerCase()}if(!r)return t;if(r instanceof Date)return r;typeof i=="string"&&(i=g.parseFormat(i));if(i.toValue)return i.toValue(r,i,s);var o=/([\-+]\d+)([dmwy])/,u=r.match(/([\-+]\d+)([dmwy])/g),f,l,c;if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(r)){r=new Date;for(c=0;c<u.length;c++){f=o.exec(u[c]),l=parseInt(f[1]);switch(f[2]){case"d":r.setUTCDate(r.getUTCDate()+l);break;case"m":r=a.prototype.moveMonth.call(a.prototype,r,l);break;case"w":r.setUTCDate(r.getUTCDate()+l*7);break;case"y":r=a.prototype.moveYear.call(a.prototype,r,l)}}return n(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),0,0,0)}u=r&&r.match(this.nonpunctuation)||[],r=new Date;var h={},p=["yyyy","yy","M","MM","m","mm","d","dd"],d={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;t-=1;while(t<0)t+=12;t%=12,e.setUTCMonth(t);while(e.getUTCMonth()!==t)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}},v,y;d.M=d.MM=d.mm=d.m,d.dd=d.d,r=n(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0);var b=i.parts.slice();u.length!==b.length&&(b=e(b).filter(function(t,n){return e.inArray(n,p)!==-1}).toArray());if(u.length===b.length){var E;for(c=0,E=b.length;c<E;c++){v=parseInt(u[c],10),f=b[c];if(isNaN(v))switch(f){case"MM":y=e(m[s].months).filter(w),v=e.inArray(y[0],m[s].months)+1;break;case"M":y=e(m[s].monthsShort).filter(w),v=e.inArray(y[0],m[s].monthsShort)+1}h[f]=v}var S,x;for(c=0;c<p.length;c++)x=p[c],x in h&&!isNaN(h[x])&&(S=new Date(r),d[x](S,h[x]),isNaN(S)||(r=S))}return r},formatDate:function(t,n,r){if(!t)return"";typeof n=="string"&&(n=g.parseFormat(n));if(n.toDisplay)return n.toDisplay(t,n,r);var i={d:t.getUTCDate(),D:m[r].daysShort[t.getUTCDay()],DD:m[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:m[r].monthsShort[t.getUTCMonth()],MM:m[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m,t=[];var s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++)s.length&&t.push(s.shift()),t.push(i[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"></th></tr><tr><th class="prev">&#171;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&#187;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};g.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+g.headTemplate+"<tbody></tbody>"+g.footTemplate+"</table>"+"</div>"+'<div class="datepicker-months">'+'<table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+"</table>"+"</div>"+'<div class="datepicker-years">'+'<table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datepicker.DPGlobal=g,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=h,this},e.fn.datepicker.version="1.5.0",e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker"))return;t.preventDefault(),p.call(n,"show")}),e(function(){p.call(e('[data-provide="datepicker-inline"]'))})}),function(e){e.fn.datepicker.dates["zh-CN"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:["周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三","四","五","六","日"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今日",format:"yyyy年mm月dd日",weekStart:1,clear:"清空"}}(jQuery),function(e){e.fn.toJSON=function(){var t={},n=this.serializeArray();return e.each(n,function(){t[this.name]!==undefined?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}}(jQuery),window.console=window.console||{log:function(){}};var OurJS=window.OurJS||{},conf=conf||{};(function(){OurJS.navi=function(){var e=!1;$("ul.nav.toggle li>a").each(function(){var t=$(this),n=t.attr("href")||"NO-ATTR-VALUE",r=location.pathname,i=r.indexOf("?");i>0&&(r=r.substr(0,i)),r=decodeURIComponent(r),r.length>1&&n.length>1&&n==r&&(e=!0,t.closest("li").addClass("active"),t.closest("li.dropdown").addClass("active"))}),!e&&$("ul.nav>li").eq(0).addClass("active");var t=$(".nav.toggle>li").click(function(e){var n=$(this),r=$("#about");t.removeClass("active"),n.addClass("active"),$(e.target).attr("id")=="aboutlink"?r.slideDown():r.slideUp()})},console.log("Powered By OurJS"),OurJS.navi()})(),function(){OurJS.formatUrl=function(){$("a.originUrl").each(function(){var e=$(this),t=e.attr("href");t=t.replace("http://www.",""),t=t.replace("http://",""),t=t.replace("https://www.",""),t=t.replace("https://","");var n=t.indexOf("/");n=n>0?n:t.length,e.text(t.substr(0,n))})},OurJS.formatUrl()}(),function(){var e=function(){window.setTimeout(function(){window.location.reload()},50)},t=function(){$("#signtab a").click(function(e){e.preventDefault(),$(this).tab("show")});var t=function(t){var n=$("#signup form:visible"),r=n.toJSON();t&&t.preventDefault();if(!n.valid())return;return $("#signOK").attr("disabled",!0),n.closest("#signuptab").size()>0&&$.post("/user.signup.post",r,function(t){$("#signOK").attr("disabled",!1),t&&t.username?($("#signupSubscribe").is(":checked")&&($("#to").val($("#signupEmail").val()),$("#subscribe").attr("target","subscribeFrame").submit(),alert("欢迎订阅我们的文摘！\r\n我们使用第三方邮件列表服务，\r\n如果您想退订\r\n在邮件正文中单击“退订”链接即可！\r\n\r\n由于第三方邮件列表的限制\r\n请您在1小时内登录邮箱，验证邮件:)")),e()):alert("注册失败！该用户名/邮箱可能被占用")},"json"),n.closest("#signintab").size()>0&&($("#signOK").attr("disabled",!1),$.post("/user.signin.post",r,function(t){t&&t.username?e():alert("登录失败！　请检查用户名或密码")},"json")),!1};$("#signuptab form").submit(t).validate({rules:{username:{minlength:4,maxlength:16,required:!0},password:{minlength:4,maxlength:32,required:!0},email:{minlength:4,maxlength:64,email:!0}}}),$("#signintab form").submit(t).validate({rules:{username:{minlength:4,maxlength:16,required:!0},password:{minlength:4,maxlength:32,required:!0}}}),$("#signOK").attr("disabled",!1).click(t),$("#useredit form").submit(function(e){var t=$(this);e.preventDefault();if(t.valid()){var n=t.toJSON();$.post("/user.edit.post",n,function(e){e.done?window.location="/user/"+n.username:alert("修改失败！ 可能是密码不匹配！")},"json")}}).validate({rules:{password:{minlength:3,maxlength:32,required:!0},email:{minlength:3,maxlength:64,email:!0,required:!0},company:{maxlength:32},briefinfo:{maxlength:300},newPassword:{minlength:3,maxlength:32},confPassword:{minlength:3,maxlength:32,equalTo:"#newPassword"}}}),$(".formatdate").each(function(){var e=$(this),t=parseInt(e.text()),r=(new Date-t)/1e3|0,i=e.hasClass("date"),s;r<0||i?s=n(t,i):r<60?s=r+"秒前":r<3600?s=parseInt(r/60)+"分钟前":r<86400?s=parseInt(r/3600)+"小时前":r<259200?s=parseInt(r/86400)+"天前":s=n(t,i),e.text(s).removeClass("hide")})},n=function(e,t,n){var r=function(e){return e<10?"0"+e:e};e=new Date(parseInt(e));var i=e.getFullYear(),s=e.getMonth()+1,o=e.getDate(),u=e.getHours(),a=e.getMinutes(),f=e.getSeconds(),e=i+"-"+r(s)+"-"+r(o),l=r(u)+":"+r(a)+":"+r(f);return n?l:t?e:e+" "+l},r=function(){$.getJSON("/user.signout.post",function(t){t.done&&e()})};t(),OurJS.Users={refresh:e,signout:r},OurJS.formatDateTime=n}(),function(){if(location.href.indexOf("/root/edit/")<0)return;var e=$("#chkContent").change(function(){$(".contentWrapper").toggle()});content&&($("#content").val(content),e.attr("checked",!0).change()),$("input, textarea").each(function(){var e=$(this),t=e.val();t.length<20&&t.trim()=="undefined"&&e.val("")}),$(".editor").wysihtml5({html:!0,stylesheets:["/css/libs.min.css","/css/prod.min.css?v=217"]}),$(".autocomplete").magicSuggest({placeholder:"[可不填]",value:keyword||"",data:keywords||[]}),$(".datetime").datepicker({format:"yyyy-mm-dd",language:"zh-CN",todayHighlight:!0})}(),function(){var e=decodeURIComponent(location.pathname),t=function(e){e.closest("li").addClass("active")};$(".pagination>ul>li>a").each(function(){var n=$(this),r=n.attr("href"),i=e.indexOf(r);i>-1&&!jQuery.isNumeric(e.charAt(i+r.length))&&t(n)}),$(".pagination>ul>li.active").size()<1&&t($(".pagination>ul>li>a").eq(0)),$("#keyNav>ul>li").removeClass("active"),$("#keyNav>ul>li>a").each(function(){var n=$(this);if(e.indexOf(n.attr("href"))>-1){t(n);return}}),$("#keyNav>ul>li.active").size()<1&&t($("#keyNav>ul>li>a").eq(0))}(),function(){var e=$(".menu.nav"),t=$(".btn.btn-navbar").on("click",function(){e.css("display",e.is(":visible")?"":"block")}),n;$(document).on("touchstart",function(r){if(n)return;n=setTimeout(function(){n=null;var i=$(r.target);t.is(":visible")&&e.is(":visible")&&i.closest(".btn-navbar").size()<1&&i.closest(".nav").size()<1&&e.css("display","")},100)})}(),function(){var e=$(".stock");if(e.size()<1)return;var t=6e5,n=function(){$.getJSON("/json/stock",function(n){if(!n.time||+(new Date)-n.time>t)return e.hide();n.time=OurJS.formatDateTime(n.time,null,!0),e.view(n,{formatter:function(e){var t=$(this);return t[0].tagName=="B"&&(e<0?t.addClass("down"):t.removeClass("down"),e+="%"),e}})})},r=(new Date).getDay();r!==6&&r!==0&&setInterval(n,4e3),n()}(),function(){var e=$.browser||{},t=NProgress;if(e.msie&&$.browser.versionNumber<8)return;t.configure({parent:".navbar .navbar-inner",template:'<div class="bar" role="bar"></div>'}),t.start(),$(document).ready(function(){t.inc(.5),setTimeout(function(){t.done()},4e3)}).ajaxStart(function(){t.start()}).ajaxComplete(function(){t.done()}),$(window).load(function(){t.done()})}(),function(){var e=$("#chart_rong"),t=function(t,n,r,i,s,o,u){var a={animation:!1,tooltip:{trigger:"axis"},grid:{left:54,right:16,top:12,bottom:"24%"},xAxis:[{type:"category",boundaryGap:!1,data:t}],yAxis:[{type:"value"}],dataZoom:[{type:"inside",start:50,end:100},{show:!0,type:"slider",y:"90%",start:50,end:100}],series:[{name:"沪深两融总额",type:"line",areaStyle:{normal:{}},data:u},{name:"沪深融券总额",type:"line",areaStyle:{normal:{}},data:o},{name:"沪市两融余额",type:"line",stack:"总量",areaStyle:{normal:{}},data:r},{name:"沪市融券余额",type:"line",stack:"总量",areaStyle:{normal:{}},data:n},{name:"深市两融余额",type:"line",stack:"总量",areaStyle:{normal:{}},data:s},{name:"深市融券余额",type:"line",stack:"总量",areaStyle:{normal:{}},data:i}]};e.closest(".chart-wrapper").size()&&$.extend(a,{animation:!1,tooltip:{trigger:"axis"},legend:{data:["沪深两融总额","沪深融券总额","沪市两融余额","沪市融券余额","深市两融余额","深市融券余额"],x:"left"},toolbox:{feature:{saveAsImage:{}}},grid:{left:54,right:16,top:48,bottom:"16%"},dataZoom:[{type:"inside",start:50,end:100},{show:!0,type:"slider",y:"90%",start:50,end:100}]});var f=echarts.init(e[0]);f.setOption(a)},n=function(){if(e.size()<1)return;$.getJSON("/json/rzrq",function(e){var n=Object.keys(e.sh).sort(),r=[],i=[],s=[],o=[],u=[],a=[],f=[];for(var l=0;l<n.length;l++){var c=n[l],h=e.sh[c].split(","),p=(e.sz[c]||"").split(","),d=parseInt(h[0]),v=parseInt(h[1]),m=parseInt(p[0]),g=parseInt(p[1]);r.push(c),i.push(d),s.push(v),o.push(m),u.push(g),a.push(d+m),f.push(g+v),p.length<2&&console.log(c,e.sz[c])}t(r,i,s,o,u,a,f)})};n()}(),function(){var e=$("#chart_baozhenjin"),t=function(t,n,r,i){var s={tooltip:{trigger:"axis",axisPointer:{type:"line"}},grid:{left:54,right:16,top:12,bottom:"24%"},xAxis:{type:"category",data:t,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"},yAxis:{scale:!0,splitArea:{show:!0}},dataZoom:[{type:"inside",start:50,end:100},{show:!0,type:"slider",y:"90%",start:50,end:100}],series:[{name:"期末余额",type:"line",areaStyle:{normal:{}},data:n},{name:"转入金额",type:"line",areaStyle:{normal:{}},data:r},{name:"转出金额",type:"line",areaStyle:{normal:{}},data:i}]};e.closest(".chart-wrapper").size()&&$.extend(s,{toolbox:{feature:{saveAsImage:{}}},legend:{data:["期末余额","转入金额","转出金额"],x:"left"},grid:{left:54,right:16,top:48,bottom:"16%"}});var o=echarts.init(e[0]);o.setOption(s)},n=function(){if(e.size()<1)return;$.getJSON("/json/baozhenjin",function(e){var n=e.baozhenjin,r=[],i=[],s=[],o=[];for(var u=0;u<n.length;u++){var a=n[u],f=a[1].split(",");r.push(a[0]),i.push(parseInt(f[0])),s.push(parseInt(f[2])),o.push(parseInt(f[3]))}t(r,i,s,o)})};n()}()/* Powered by OurJS.com */